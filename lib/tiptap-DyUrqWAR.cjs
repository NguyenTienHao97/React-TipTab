"use strict";var Ne=Object.defineProperty;var $e=(e,t,n)=>t in e?Ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var tt=(e,t,n)=>$e(e,typeof t!="symbol"?t+"":t,n);const he=require("tippy.js"),m=require("./vendor-D68ieoKh.cjs"),A=require("react"),fe=require("react-dom");function dt(e){const{state:t,transaction:n}=e;let{selection:r}=n,{doc:s}=n,{storedMarks:o}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return r},get doc(){return s},get tr(){return r=n.selection,s=n.doc,o=n.storedMarks,n}}}class ut{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:r}=this,{view:s}=n,{tr:o}=r,i=this.buildProps(o);return Object.fromEntries(Object.entries(t).map(([a,c])=>[a,(...u)=>{const d=c(...u)(i);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(o),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:r,editor:s,state:o}=this,{view:i}=s,a=[],c=!!t,l=t||o.tr,u=()=>(!c&&n&&!l.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(l),a.every(p=>p===!0)),d={...Object.fromEntries(Object.entries(r).map(([p,h])=>[p,(...g)=>{const y=this.buildProps(l,n),v=h(...g)(y);return a.push(v),d}])),run:u};return d}createCan(t){const{rawCommands:n,state:r}=this,s=!1,o=t||r.tr,i=this.buildProps(o,s);return{...Object.fromEntries(Object.entries(n).map(([c,l])=>[c,(...u)=>l(...u)({...i,dispatch:void 0})])),chain:()=>this.createChain(o,s)}}buildProps(t,n=!0){const{rawCommands:r,editor:s,state:o}=this,{view:i}=s,a={tr:t,editor:s,view:i,state:dt({state:o,transaction:t}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(t,n),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(r).map(([c,l])=>[c,(...u)=>l(...u)(a)]))}};return a}}class Be{constructor(){this.callbacks={}}on(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),this}emit(t,...n){const r=this.callbacks[t];return r&&r.forEach(s=>s.apply(this,n)),this}off(t,n){const r=this.callbacks[t];return r&&(n?this.callbacks[t]=r.filter(s=>s!==n):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}function k(e,t,n){return e.config[t]===void 0&&e.parent?k(e.parent,t,n):typeof e.config[t]=="function"?e.config[t].bind({...n,parent:e.parent?k(e.parent,t,n):null}):e.config[t]}function pt(e){const t=e.filter(s=>s.type==="extension"),n=e.filter(s=>s.type==="node"),r=e.filter(s=>s.type==="mark");return{baseExtensions:t,nodeExtensions:n,markExtensions:r}}function me(e){const t=[],{nodeExtensions:n,markExtensions:r}=pt(e),s=[...n,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage,extensions:s},c=k(i,"addGlobalAttributes",a);if(!c)return;c().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([p,h])=>{t.push({type:d,name:p,attribute:{...o,...h}})})})})}),s.forEach(i=>{const a={name:i.name,options:i.options,storage:i.storage},c=k(i,"addAttributes",a);if(!c)return;const l=c();Object.entries(l).forEach(([u,d])=>{const p={...o,...d};typeof(p==null?void 0:p.default)=="function"&&(p.default=p.default()),p!=null&&p.isRequired&&(p==null?void 0:p.default)===void 0&&delete p.default,t.push({type:i.name,name:u,attribute:p})})}),t}function _(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function O(...e){return e.filter(t=>!!t).reduce((t,n)=>{const r={...t};return Object.entries(n).forEach(([s,o])=>{if(!r[s]){r[s]=o;return}if(s==="class"){const a=o?o.split(" "):[],c=r[s]?r[s].split(" "):[],l=a.filter(u=>!c.includes(u));r[s]=[...c,...l].join(" ")}else if(s==="style"){const a=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],c=r[s]?r[s].split(";").map(u=>u.trim()).filter(Boolean):[],l=new Map;c.forEach(u=>{const[d,p]=u.split(":").map(h=>h.trim());l.set(d,p)}),a.forEach(u=>{const[d,p]=u.split(":").map(h=>h.trim());l.set(d,p)}),r[s]=Array.from(l.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[s]=o}),r},{})}function at(e,t){return t.filter(n=>n.type===e.type.name).filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(e.attrs)||{}:{[n.name]:e.attrs[n.name]}).reduce((n,r)=>O(n,r),{})}function ge(e){return typeof e=="function"}function C(e,t=void 0,...n){return ge(e)?t?e.bind(t)(...n):e(...n):e}function je(e={}){return Object.keys(e).length===0&&e.constructor===Object}function Fe(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function qt(e,t){return"style"in e?e:{...e,getAttrs:n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(r===!1)return!1;const s=t.reduce((o,i)=>{const a=i.attribute.parseHTML?i.attribute.parseHTML(n):Fe(n.getAttribute(i.name));return a==null?o:{...o,[i.name]:a}},{});return{...r,...s}}}}function Ut(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>t==="attrs"&&je(n)?!1:n!=null))}function ze(e,t){var n;const r=me(e),{nodeExtensions:s,markExtensions:o}=pt(e),i=(n=s.find(l=>k(l,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(s.map(l=>{const u=r.filter(v=>v.type===l.name),d={name:l.name,options:l.options,storage:l.storage,editor:t},p=e.reduce((v,w)=>{const M=k(w,"extendNodeSchema",d);return{...v,...M?M(l):{}}},{}),h=Ut({...p,content:C(k(l,"content",d)),marks:C(k(l,"marks",d)),group:C(k(l,"group",d)),inline:C(k(l,"inline",d)),atom:C(k(l,"atom",d)),selectable:C(k(l,"selectable",d)),draggable:C(k(l,"draggable",d)),code:C(k(l,"code",d)),whitespace:C(k(l,"whitespace",d)),defining:C(k(l,"defining",d)),isolating:C(k(l,"isolating",d)),attrs:Object.fromEntries(u.map(v=>{var w;return[v.name,{default:(w=v==null?void 0:v.attribute)===null||w===void 0?void 0:w.default}]}))}),f=C(k(l,"parseHTML",d));f&&(h.parseDOM=f.map(v=>qt(v,u)));const g=k(l,"renderHTML",d);g&&(h.toDOM=v=>g({node:v,HTMLAttributes:at(v,u)}));const y=k(l,"renderText",d);return y&&(h.toText=y),[l.name,h]})),c=Object.fromEntries(o.map(l=>{const u=r.filter(y=>y.type===l.name),d={name:l.name,options:l.options,storage:l.storage,editor:t},p=e.reduce((y,v)=>{const w=k(v,"extendMarkSchema",d);return{...y,...w?w(l):{}}},{}),h=Ut({...p,inclusive:C(k(l,"inclusive",d)),excludes:C(k(l,"excludes",d)),group:C(k(l,"group",d)),spanning:C(k(l,"spanning",d)),code:C(k(l,"code",d)),attrs:Object.fromEntries(u.map(y=>{var v;return[y.name,{default:(v=y==null?void 0:y.attribute)===null||v===void 0?void 0:v.default}]}))}),f=C(k(l,"parseHTML",d));f&&(h.parseDOM=f.map(y=>qt(y,u)));const g=k(l,"renderHTML",d);return g&&(h.toDOM=y=>g({mark:y,HTMLAttributes:at(y,u)})),[l.name,h]}));return new m.Schema({topNode:i,nodes:a,marks:c})}function kt(e,t){return t.nodes[e]||t.marks[e]||null}function Gt(e,t){return Array.isArray(t)?t.some(n=>(typeof n=="string"?n:n.name)===e.name):t}const Ve=(e,t=500)=>{let n="";const r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(s,o,i,a)=>{var c,l;const u=((l=(c=s.type.spec).toText)===null||l===void 0?void 0:l.call(c,{node:s,pos:o,parent:i,index:a}))||s.textContent||"%leaf%";n+=s.isAtom&&!s.isText?u:u.slice(0,Math.max(0,r-o))}),n};function $t(e){return Object.prototype.toString.call(e)==="[object RegExp]"}class ht{constructor(t){this.find=t.find,this.handler=t.handler}}const We=(e,t)=>{if($t(t))return t.exec(e);const n=t(e);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r};function et(e){var t;const{editor:n,from:r,to:s,text:o,rules:i,plugin:a}=e,{view:c}=n;if(c.composing)return!1;const l=c.state.doc.resolve(r);if(l.parent.type.spec.code||!((t=l.nodeBefore||l.nodeAfter)===null||t===void 0)&&t.marks.find(p=>p.type.spec.code))return!1;let u=!1;const d=Ve(l)+o;return i.forEach(p=>{if(u)return;const h=We(d,p.find);if(!h)return;const f=c.state.tr,g=dt({state:c.state,transaction:f}),y={from:r-(h[0].length-o.length),to:s},{commands:v,chain:w,can:M}=new ut({editor:n,state:g});p.handler({state:g,range:y,match:h,commands:v,chain:w,can:M})===null||!f.steps.length||(f.setMeta(a,{transform:f,from:r,to:s,text:o}),c.dispatch(f),u=!0)}),u}function Ke(e){const{editor:t,rules:n}=e,r=new m.Plugin({state:{init(){return null},apply(s,o){const i=s.getMeta(r);if(i)return i;const a=s.getMeta("applyInputRules");return!!a&&setTimeout(()=>{const{from:l,text:u}=a,d=l+u.length;et({editor:t,from:l,to:d,text:u,rules:n,plugin:r})}),s.selectionSet||s.docChanged?null:o}},props:{handleTextInput(s,o,i,a){return et({editor:t,from:o,to:i,text:a,rules:n,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:o}=s.state.selection;o&&et({editor:t,from:o.pos,to:o.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(s,o){if(o.key!=="Enter")return!1;const{$cursor:i}=s.state.selection;return i?et({editor:t,from:i.pos,to:i.pos,text:`
`,rules:n,plugin:r}):!1}},isInputRules:!0});return r}function qe(e){return Object.prototype.toString.call(e).slice(8,-1)}function nt(e){return qe(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function ft(e,t){const n={...e};return nt(e)&&nt(t)&&Object.keys(t).forEach(r=>{nt(t[r])&&nt(e[r])?n[r]=ft(e[r],t[r]):n[r]=t[r]}),n}class D{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=C(k(this,"addOptions",{name:this.name}))),this.storage=C(k(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new D(t)}configure(t={}){const n=this.extend({...this.config,addOptions:()=>ft(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new D(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=C(k(n,"addOptions",{name:n.name})),n.storage=C(k(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:t,mark:n}){const{tr:r}=t.state,s=t.state.selection.$from;if(s.pos===s.end()){const i=s.marks();if(!!!i.find(l=>(l==null?void 0:l.type.name)===n.name))return!1;const c=i.find(l=>(l==null?void 0:l.type.name)===n.name);return c&&r.removeStoredMark(c),r.insertText(" ",s.pos),t.view.dispatch(r),!0}return!1}}function ye(e){return typeof e=="number"}class ve{constructor(t){this.find=t.find,this.handler=t.handler}}const Ue=(e,t,n)=>{if($t(t))return[...e.matchAll(t)];const r=t(e,n);return r?r.map(s=>{const o=[s.text];return o.index=s.index,o.input=e,o.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(s.replaceWith)),o}):[]};function Ge(e){const{editor:t,state:n,from:r,to:s,rule:o,pasteEvent:i,dropEvent:a}=e,{commands:c,chain:l,can:u}=new ut({editor:t,state:n}),d=[];return n.doc.nodesBetween(r,s,(h,f)=>{if(!h.isTextblock||h.type.spec.code)return;const g=Math.max(r,f),y=Math.min(s,f+h.content.size),v=h.textBetween(g-f,y-f,void 0,"￼");Ue(v,o.find,i).forEach(M=>{if(M.index===void 0)return;const b=g+M.index+1,E=b+M[0].length,S={from:n.tr.mapping.map(b),to:n.tr.mapping.map(E)},x=o.handler({state:n,range:S,match:M,commands:c,chain:l,can:u,pasteEvent:i,dropEvent:a});d.push(x)})}),d.every(h=>h!==null)}const Je=e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(t=n.clipboardData)===null||t===void 0||t.setData("text/html",e),n};function Ye(e){const{editor:t,rules:n}=e;let r=null,s=!1,o=!1,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a=typeof DragEvent<"u"?new DragEvent("drop"):null;const c=({state:u,from:d,to:p,rule:h,pasteEvt:f})=>{const g=u.tr,y=dt({state:u,transaction:g});if(!(!Ge({editor:t,state:y,from:Math.max(d-1,0),to:p.b-1,rule:h,pasteEvent:f,dropEvent:a})||!g.steps.length))return a=typeof DragEvent<"u"?new DragEvent("drop"):null,i=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,g};return n.map(u=>new m.Plugin({view(d){const p=h=>{var f;r=!((f=d.dom.parentElement)===null||f===void 0)&&f.contains(h.target)?d.dom.parentElement:null};return window.addEventListener("dragstart",p),{destroy(){window.removeEventListener("dragstart",p)}}},props:{handleDOMEvents:{drop:(d,p)=>(o=r===d.dom.parentElement,a=p,!1),paste:(d,p)=>{var h;const f=(h=p.clipboardData)===null||h===void 0?void 0:h.getData("text/html");return i=p,s=!!(f!=null&&f.includes("data-pm-slice")),!1}}},appendTransaction:(d,p,h)=>{const f=d[0],g=f.getMeta("uiEvent")==="paste"&&!s,y=f.getMeta("uiEvent")==="drop"&&!o,v=f.getMeta("applyPasteRules"),w=!!v;if(!g&&!y&&!w)return;if(w){const{from:E,text:S}=v,x=E+S.length,L=Je(S);return c({rule:u,state:h,from:E,to:{b:x},pasteEvt:L})}const M=p.doc.content.findDiffStart(h.doc.content),b=p.doc.content.findDiffEnd(h.doc.content);if(!(!ye(M)||!b||M===b.b))return c({rule:u,state:h,from:M,to:b,pasteEvt:i})}}))}function Xe(e){const t=e.filter((n,r)=>e.indexOf(n)!==r);return Array.from(new Set(t))}class Y{constructor(t,n){this.splittableMarks=[],this.editor=n,this.extensions=Y.resolve(t),this.schema=ze(this.extensions,n),this.setupExtensions()}static resolve(t){const n=Y.sort(Y.flatten(t)),r=Xe(n.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),n}static flatten(t){return t.map(n=>{const r={name:n.name,options:n.options,storage:n.storage},s=k(n,"addExtensions",r);return s?[n,...this.flatten(s())]:n}).flat(10)}static sort(t){return t.sort((r,s)=>{const o=k(r,"priority")||100,i=k(s,"priority")||100;return o>i?-1:o<i?1:0})}get commands(){return this.extensions.reduce((t,n)=>{const r={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:kt(n.name,this.schema)},s=k(n,"addCommands",r);return s?{...t,...s()}:t},{})}get plugins(){const{editor:t}=this,n=Y.sort([...this.extensions].reverse()),r=[],s=[],o=n.map(i=>{const a={name:i.name,options:i.options,storage:i.storage,editor:t,type:kt(i.name,this.schema)},c=[],l=k(i,"addKeyboardShortcuts",a);let u={};if(i.type==="mark"&&k(i,"exitable",a)&&(u.ArrowRight=()=>D.handleExit({editor:t,mark:i})),l){const g=Object.fromEntries(Object.entries(l()).map(([y,v])=>[y,()=>v({editor:t})]));u={...u,...g}}const d=m.keymap(u);c.push(d);const p=k(i,"addInputRules",a);Gt(i,t.options.enableInputRules)&&p&&r.push(...p());const h=k(i,"addPasteRules",a);Gt(i,t.options.enablePasteRules)&&h&&s.push(...h());const f=k(i,"addProseMirrorPlugins",a);if(f){const g=f();c.push(...g)}return c}).flat();return[Ke({editor:t,rules:r}),...Ye({editor:t,rules:s}),...o]}get attributes(){return me(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:n}=pt(this.extensions);return Object.fromEntries(n.filter(r=>!!k(r,"addNodeView")).map(r=>{const s=this.attributes.filter(c=>c.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:t,type:_(r.name,this.schema)},i=k(r,"addNodeView",o);if(!i)return[];const a=(c,l,u,d,p)=>{const h=at(c,s);return i()({node:c,view:l,getPos:u,decorations:d,innerDecorations:p,editor:t,extension:r,HTMLAttributes:h})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(t=>{var n;this.editor.extensionStorage[t.name]=t.storage;const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:kt(t.name,this.schema)};t.type==="mark"&&(!((n=C(k(t,"keepOnSplit",r)))!==null&&n!==void 0)||n)&&this.splittableMarks.push(t.name);const s=k(t,"onBeforeCreate",r),o=k(t,"onCreate",r),i=k(t,"onUpdate",r),a=k(t,"onSelectionUpdate",r),c=k(t,"onTransaction",r),l=k(t,"onFocus",r),u=k(t,"onBlur",r),d=k(t,"onDestroy",r);s&&this.editor.on("beforeCreate",s),o&&this.editor.on("create",o),i&&this.editor.on("update",i),a&&this.editor.on("selectionUpdate",a),c&&this.editor.on("transaction",c),l&&this.editor.on("focus",l),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}}class H{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=C(k(this,"addOptions",{name:this.name}))),this.storage=C(k(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new H(t)}configure(t={}){const n=this.extend({...this.config,addOptions:()=>ft(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new H({...this.config,...t});return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=C(k(n,"addOptions",{name:n.name})),n.storage=C(k(n,"addStorage",{name:n.name,options:n.options})),n}}function be(e,t,n){const{from:r,to:s}=t,{blockSeparator:o=`

`,textSerializers:i={}}=n||{};let a="";return e.nodesBetween(r,s,(c,l,u,d)=>{var p;c.isBlock&&l>r&&(a+=o);const h=i==null?void 0:i[c.type.name];if(h)return u&&(a+=h({node:c,pos:l,parent:u,index:d,range:t})),!1;c.isText&&(a+=(p=c==null?void 0:c.text)===null||p===void 0?void 0:p.slice(Math.max(r,l)-l,s-l))}),a}function Me(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}const Qe=H.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new m.Plugin({key:new m.PluginKey("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:s}=t,{ranges:o}=s,i=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),c=Me(n);return be(r,{from:i,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:c})}}})]}}),Ze=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),(n=window==null?void 0:window.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),tn=(e=!1)=>({commands:t})=>t.setContent("",e),en=()=>({state:e,tr:t,dispatch:n})=>{const{selection:r}=t,{ranges:s}=r;return n&&s.forEach(({$from:o,$to:i})=>{e.doc.nodesBetween(o.pos,i.pos,(a,c)=>{if(a.type.isText)return;const{doc:l,mapping:u}=t,d=l.resolve(u.map(c)),p=l.resolve(u.map(c+a.nodeSize)),h=d.blockRange(p);if(!h)return;const f=m.liftTarget(h);if(a.type.isTextblock){const{defaultType:g}=d.parent.contentMatchAt(d.index());t.setNodeMarkup(h.start,g)}(f||f===0)&&t.lift(h,f)})}),!0},nn=e=>t=>e(t),rn=()=>({state:e,dispatch:t})=>m.createParagraphNear(e,t),sn=(e,t)=>({editor:n,tr:r})=>{const{state:s}=n,o=s.doc.slice(e.from,e.to);r.deleteRange(e.from,e.to);const i=r.mapping.map(t);return r.insert(i,o.content),r.setSelection(new m.TextSelection(r.doc.resolve(i-1))),!0},on=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,r=n.$anchor.node();if(r.content.size>0)return!1;const s=e.selection.$anchor;for(let o=s.depth;o>0;o-=1)if(s.node(o).type===r.type){if(t){const a=s.before(o),c=s.after(o);e.delete(a,c).scrollIntoView()}return!0}return!1},an=e=>({tr:t,state:n,dispatch:r})=>{const s=_(e,n.schema),o=t.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===s){if(r){const c=o.before(i),l=o.after(i);t.delete(c,l).scrollIntoView()}return!0}return!1},ln=e=>({tr:t,dispatch:n})=>{const{from:r,to:s}=e;return n&&t.delete(r,s),!0},cn=()=>({state:e,dispatch:t})=>m.deleteSelection(e,t),dn=()=>({commands:e})=>e.keyboardShortcut("Enter"),un=()=>({state:e,dispatch:t})=>m.exitCode(e,t);function lt(e,t,n={strict:!0}){const r=Object.keys(t);return r.length?r.every(s=>n.strict?t[s]===e[s]:$t(t[s])?t[s].test(e[s]):t[s]===e[s]):!0}function Lt(e,t,n={}){return e.find(r=>r.type===t&&lt(r.attrs,n))}function pn(e,t,n={}){return!!Lt(e,t,n)}function mt(e,t,n={}){if(!e||!t)return;let r=e.parent.childAfter(e.parentOffset);if((!r.node||!r.node.marks.some(l=>l.type===t))&&(r=e.parent.childBefore(e.parentOffset)),!r.node||!r.node.marks.some(l=>l.type===t))return;const s=Lt([...r.node.marks],t,n);if(!s)return;let o=r.index,i=e.start()+r.offset,a=o+1,c=i+r.node.nodeSize;for(Lt([...r.node.marks],t,n);o>0&&s.isInSet(e.parent.child(o-1).marks);)o-=1,i-=e.parent.child(o).nodeSize;for(;a<e.parent.childCount&&pn([...e.parent.child(a).marks],t,n);)c+=e.parent.child(a).nodeSize,a+=1;return{from:i,to:c}}function z(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}const hn=(e,t={})=>({tr:n,state:r,dispatch:s})=>{const o=z(e,r.schema),{doc:i,selection:a}=n,{$from:c,from:l,to:u}=a;if(s){const d=mt(c,o,t);if(d&&d.from<=l&&d.to>=u){const p=m.TextSelection.create(i,d.from,d.to);n.setSelection(p)}}return!0},fn=e=>t=>{const n=typeof e=="function"?e(t):e;for(let r=0;r<n.length;r+=1)if(n[r](t))return!0;return!1};function Bt(e){return e instanceof m.TextSelection}function $(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function Se(e,t=null){if(!t)return null;const n=m.Selection.atStart(e),r=m.Selection.atEnd(e);if(t==="start"||t===!0)return n;if(t==="end")return r;const s=n.from,o=r.to;return t==="all"?m.TextSelection.create(e,$(0,s,o),$(e.content.size,s,o)):m.TextSelection.create(e,$(t,s,o),$(t,s,o))}function gt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const mn=(e=null,t={})=>({editor:n,view:r,tr:s,dispatch:o})=>{t={scrollIntoView:!0,...t};const i=()=>{gt()&&r.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(r.focus(),t!=null&&t.scrollIntoView&&n.commands.scrollIntoView())})};if(r.hasFocus()&&e===null||e===!1)return!0;if(o&&e===null&&!Bt(n.state.selection))return i(),!0;const a=Se(s.doc,e)||n.state.selection,c=n.state.selection.eq(a);return o&&(c||s.setSelection(a),c&&s.storedMarks&&s.setStoredMarks(s.storedMarks),i()),!0},gn=(e,t)=>n=>e.every((r,s)=>t(r,{...n,index:s})),yn=(e,t)=>({tr:n,commands:r})=>r.insertContentAt({from:n.selection.from,to:n.selection.to},e,t),ke=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const r=t[n];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):r.nodeType===1&&ke(r)}return e};function rt(e){const t=`<body>${e}</body>`,n=new window.DOMParser().parseFromString(t,"text/html").body;return ke(n)}function ct(e,t,n){n={slice:!0,parseOptions:{},...n};const r=typeof e=="object"&&e!==null,s=typeof e=="string";if(r)try{if(Array.isArray(e)&&e.length>0)return m.Fragment.fromArray(e.map(a=>t.nodeFromJSON(a)));const i=t.nodeFromJSON(e);return n.errorOnInvalidContent&&i.check(),i}catch(o){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",o),ct("",t,n)}if(s){if(n.errorOnInvalidContent){let i=!1,a="";const c=new m.Schema({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:l=>(i=!0,a=typeof l=="string"?l:l.outerHTML,null)}]}})});if(n.slice?m.DOMParser.fromSchema(c).parseSlice(rt(e),n.parseOptions):m.DOMParser.fromSchema(c).parse(rt(e),n.parseOptions),n.errorOnInvalidContent&&i)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=m.DOMParser.fromSchema(t);return n.slice?o.parseSlice(rt(e),n.parseOptions).content:o.parse(rt(e),n.parseOptions)}return ct("",t,n)}function vn(e,t,n){const r=e.steps.length-1;if(r<t)return;const s=e.steps[r];if(!(s instanceof m.ReplaceStep||s instanceof m.ReplaceAroundStep))return;const o=e.mapping.maps[r];let i=0;o.forEach((a,c,l,u)=>{i===0&&(i=u)}),e.setSelection(m.Selection.near(e.doc.resolve(i),n))}const bn=e=>!("type"in e),Mn=(e,t,n)=>({tr:r,dispatch:s,editor:o})=>{var i;if(s){n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n};let a;try{a=ct(t,o.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions},errorOnInvalidContent:(i=n.errorOnInvalidContent)!==null&&i!==void 0?i:o.options.enableContentCheck})}catch(f){return o.emit("contentError",{editor:o,error:f,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}}),!1}let{from:c,to:l}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},u=!0,d=!0;if((bn(a)?a:[a]).forEach(f=>{f.check(),u=u?f.isText&&f.marks.length===0:!1,d=d?f.isBlock:!1}),c===l&&d){const{parent:f}=r.doc.resolve(c);f.isTextblock&&!f.type.spec.code&&!f.childCount&&(c-=1,l+=1)}let h;u?(Array.isArray(t)?h=t.map(f=>f.text||"").join(""):typeof t=="object"&&t&&t.text?h=t.text:h=t,r.insertText(h,c,l)):(h=a,r.replaceWith(c,l,h)),n.updateSelection&&vn(r,r.steps.length-1,-1),n.applyInputRules&&r.setMeta("applyInputRules",{from:c,text:h}),n.applyPasteRules&&r.setMeta("applyPasteRules",{from:c,text:h})}return!0},Sn=()=>({state:e,dispatch:t})=>m.joinUp(e,t),kn=()=>({state:e,dispatch:t})=>m.joinDown(e,t),wn=()=>({state:e,dispatch:t})=>m.joinBackward(e,t),Tn=()=>({state:e,dispatch:t})=>m.joinForward(e,t),En=()=>({state:e,dispatch:t,tr:n})=>{try{const r=m.joinPoint(e.doc,e.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},Cn=()=>({state:e,dispatch:t,tr:n})=>{try{const r=m.joinPoint(e.doc,e.selection.$from.pos,1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},xn=()=>({state:e,dispatch:t})=>m.joinTextblockBackward(e,t),An=()=>({state:e,dispatch:t})=>m.joinTextblockForward(e,t);function we(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function On(e){const t=e.split(/-(?!$)/);let n=t[t.length-1];n==="Space"&&(n=" ");let r,s,o,i;for(let a=0;a<t.length-1;a+=1){const c=t[a];if(/^(cmd|meta|m)$/i.test(c))i=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))s=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))gt()||we()?i=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${c}`)}return r&&(n=`Alt-${n}`),s&&(n=`Ctrl-${n}`),i&&(n=`Meta-${n}`),o&&(n=`Shift-${n}`),n}const Ln=e=>({editor:t,view:n,tr:r,dispatch:s})=>{const o=On(e).split(/-(?!$)/),i=o.find(l=>!["Alt","Ctrl","Meta","Shift"].includes(l)),a=new KeyboardEvent("keydown",{key:i==="Space"?" ":i,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),c=t.captureTransaction(()=>{n.someProp("handleKeyDown",l=>l(n,a))});return c==null||c.steps.forEach(l=>{const u=l.map(r.mapping);u&&s&&r.maybeStep(u)}),!0};function Z(e,t,n={}){const{from:r,to:s,empty:o}=e.selection,i=t?_(t,e.schema):null,a=[];e.doc.nodesBetween(r,s,(d,p)=>{if(d.isText)return;const h=Math.max(r,p),f=Math.min(s,p+d.nodeSize);a.push({node:d,from:h,to:f})});const c=s-r,l=a.filter(d=>i?i.name===d.node.type.name:!0).filter(d=>lt(d.node.attrs,n,{strict:!1}));return o?!!l.length:l.reduce((d,p)=>d+p.to-p.from,0)>=c}const Pn=(e,t={})=>({state:n,dispatch:r})=>{const s=_(e,n.schema);return Z(n,s,t)?m.lift(n,r):!1},Rn=()=>({state:e,dispatch:t})=>m.liftEmptyBlock(e,t),Hn=e=>({state:t,dispatch:n})=>{const r=_(e,t.schema);return m.liftListItem(r)(t,n)},_n=()=>({state:e,dispatch:t})=>m.newlineInCode(e,t);function yt(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function Jt(e,t){const n=typeof t=="string"?[t]:t;return Object.keys(e).reduce((r,s)=>(n.includes(s)||(r[s]=e[s]),r),{})}const Dn=(e,t)=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const a=yt(typeof e=="string"?e:e.name,r.schema);return a?(a==="node"&&(o=_(e,r.schema)),a==="mark"&&(i=z(e,r.schema)),s&&n.selection.ranges.forEach(c=>{r.doc.nodesBetween(c.$from.pos,c.$to.pos,(l,u)=>{o&&o===l.type&&n.setNodeMarkup(u,void 0,Jt(l.attrs,t)),i&&l.marks.length&&l.marks.forEach(d=>{i===d.type&&n.addMark(u,u+l.nodeSize,i.create(Jt(d.attrs,t)))})})}),!0):!1},In=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),Nn=()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),$n=()=>({state:e,dispatch:t})=>m.selectNodeBackward(e,t),Bn=()=>({state:e,dispatch:t})=>m.selectNodeForward(e,t),jn=()=>({state:e,dispatch:t})=>m.selectParentNode(e,t),Fn=()=>({state:e,dispatch:t})=>m.selectTextblockEnd(e,t),zn=()=>({state:e,dispatch:t})=>m.selectTextblockStart(e,t);function Pt(e,t,n={},r={}){return ct(e,t,{slice:!1,parseOptions:n,errorOnInvalidContent:r.errorOnInvalidContent})}const Vn=(e,t=!1,n={},r={})=>({editor:s,tr:o,dispatch:i,commands:a})=>{var c,l;const{doc:u}=o;if(n.preserveWhitespace!=="full"){const d=Pt(e,s.schema,n,{errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:s.options.enableContentCheck});return i&&o.replaceWith(0,u.content.size,d).setMeta("preventUpdate",!t),!0}return i&&o.setMeta("preventUpdate",!t),a.insertContentAt({from:0,to:u.content.size},e,{parseOptions:n,errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:s.options.enableContentCheck})};function jt(e,t){const n=z(t,e.schema),{from:r,to:s,empty:o}=e.selection,i=[];o?(e.storedMarks&&i.push(...e.storedMarks),i.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,s,c=>{i.push(...c.marks)});const a=i.find(c=>c.type.name===n.name);return a?{...a.attrs}:{}}function Wn(e,t){const n=new m.Transform(e);return t.forEach(r=>{r.steps.forEach(s=>{n.step(s)})}),n}function Kn(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function qn(e,t){const n=[];return e.descendants((r,s)=>{t(r)&&n.push({node:r,pos:s})}),n}function Un(e,t,n){const r=[];return e.nodesBetween(t.from,t.to,(s,o)=>{n(s)&&r.push({node:s,pos:o})}),r}function Te(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}function vt(e){return t=>Te(t.$from,e)}function Gn(e,t){const n=m.DOMSerializer.fromSchema(t).serializeFragment(e),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(n),s.innerHTML}function Jn(e,t){const n={from:0,to:e.content.size};return be(e,n,t)}function Yn(e,t){const n=_(t,e.schema),{from:r,to:s}=e.selection,o=[];e.doc.nodesBetween(r,s,a=>{o.push(a)});const i=o.reverse().find(a=>a.type.name===n.name);return i?{...i.attrs}:{}}function Ee(e,t){const n=yt(typeof t=="string"?t:t.name,e.schema);return n==="node"?Yn(e,t):n==="mark"?jt(e,t):{}}function Xn(e,t=JSON.stringify){const n={};return e.filter(r=>{const s=t(r);return Object.prototype.hasOwnProperty.call(n,s)?!1:n[s]=!0})}function Qn(e){const t=Xn(e);return t.length===1?t:t.filter((n,r)=>!t.filter((o,i)=>i!==r).some(o=>n.oldRange.from>=o.oldRange.from&&n.oldRange.to<=o.oldRange.to&&n.newRange.from>=o.newRange.from&&n.newRange.to<=o.newRange.to))}function Zn(e){const{mapping:t,steps:n}=e,r=[];return t.maps.forEach((s,o)=>{const i=[];if(s.ranges.length)s.forEach((a,c)=>{i.push({from:a,to:c})});else{const{from:a,to:c}=n[o];if(a===void 0||c===void 0)return;i.push({from:a,to:c})}i.forEach(({from:a,to:c})=>{const l=t.slice(o).map(a,-1),u=t.slice(o).map(c),d=t.invert().map(l,-1),p=t.invert().map(u);r.push({oldRange:{from:d,to:p},newRange:{from:l,to:u}})})}),Qn(r)}function Ft(e,t,n){const r=[];return e===t?n.resolve(e).marks().forEach(s=>{const o=n.resolve(e),i=mt(o,s.type);i&&r.push({mark:s,...i})}):n.nodesBetween(e,t,(s,o)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(i=>({from:o,to:o+s.nodeSize,mark:i})))}),r}function it(e,t,n){return Object.fromEntries(Object.entries(n).filter(([r])=>{const s=e.find(o=>o.type===t&&o.name===r);return s?s.attribute.keepOnSplit:!1}))}function Rt(e,t,n={}){const{empty:r,ranges:s}=e.selection,o=t?z(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>lt(d.attrs,n,{strict:!1}));let i=0;const a=[];if(s.forEach(({$from:d,$to:p})=>{const h=d.pos,f=p.pos;e.doc.nodesBetween(h,f,(g,y)=>{if(!g.isText&&!g.marks.length)return;const v=Math.max(h,y),w=Math.min(f,y+g.nodeSize),M=w-v;i+=M,a.push(...g.marks.map(b=>({mark:b,from:v,to:w})))})}),i===0)return!1;const c=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>lt(d.mark.attrs,n,{strict:!1})).reduce((d,p)=>d+p.to-p.from,0),l=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,p)=>d+p.to-p.from,0);return(c>0?c+l:c)>=i}function Ce(e,t,n={}){if(!t)return Z(e,null,n)||Rt(e,null,n);const r=yt(t,e.schema);return r==="node"?Z(e,t,n):r==="mark"?Rt(e,t,n):!1}function Ht(e,t){const{nodeExtensions:n}=pt(t),r=n.find(i=>i.name===e);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},o=C(k(r,"group",s));return typeof o!="string"?!1:o.split(" ").includes("list")}function bt(e,{checkChildren:t=!0,ignoreWhitespace:n=!1}={}){var r;if(n){if(e.type.name==="hardBreak")return!0;if(e.isText)return/^\s*$/m.test((r=e.text)!==null&&r!==void 0?r:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(e.content.childCount===0)return!0;if(t){let s=!0;return e.content.forEach(o=>{s!==!1&&(bt(o,{ignoreWhitespace:n,checkChildren:t})||(s=!1))}),s}return!1}function xe(e){return e instanceof m.NodeSelection}function tr(e,t,n){const s=e.state.doc.content.size,o=$(t,0,s),i=$(n,0,s),a=e.coordsAtPos(o),c=e.coordsAtPos(i,-1),l=Math.min(a.top,c.top),u=Math.max(a.bottom,c.bottom),d=Math.min(a.left,c.left),p=Math.max(a.right,c.right),h=p-d,f=u-l,v={top:l,bottom:u,left:d,right:p,width:h,height:f,x:d,y:l};return{...v,toJSON:()=>v}}function er(e,t,n){var r;const{selection:s}=t;let o=null;if(Bt(s)&&(o=s.$cursor),o){const a=(r=e.storedMarks)!==null&&r!==void 0?r:o.marks();return!!n.isInSet(a)||!a.some(c=>c.type.excludes(n))}const{ranges:i}=s;return i.some(({$from:a,$to:c})=>{let l=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(n):!1;return e.doc.nodesBetween(a.pos,c.pos,(u,d,p)=>{if(l)return!1;if(u.isInline){const h=!p||p.type.allowsMarkType(n),f=!!n.isInSet(u.marks)||!u.marks.some(g=>g.type.excludes(n));l=h&&f}return!l}),l})}const nr=(e,t={})=>({tr:n,state:r,dispatch:s})=>{const{selection:o}=n,{empty:i,ranges:a}=o,c=z(e,r.schema);if(s)if(i){const l=jt(r,c);n.addStoredMark(c.create({...l,...t}))}else a.forEach(l=>{const u=l.$from.pos,d=l.$to.pos;r.doc.nodesBetween(u,d,(p,h)=>{const f=Math.max(h,u),g=Math.min(h+p.nodeSize,d);p.marks.find(v=>v.type===c)?p.marks.forEach(v=>{c===v.type&&n.addMark(f,g,c.create({...v.attrs,...t}))}):n.addMark(f,g,c.create(t))})});return er(r,n,c)},rr=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),sr=(e,t={})=>({state:n,dispatch:r,chain:s})=>{const o=_(e,n.schema);return o.isTextblock?s().command(({commands:i})=>m.setBlockType(o,t)(n)?!0:i.clearNodes()).command(({state:i})=>m.setBlockType(o,t)(i,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},or=e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,s=$(e,0,r.content.size),o=m.NodeSelection.create(r,s);t.setSelection(o)}return!0},ir=e=>({tr:t,dispatch:n})=>{if(n){const{doc:r}=t,{from:s,to:o}=typeof e=="number"?{from:e,to:e}:e,i=m.TextSelection.atStart(r).from,a=m.TextSelection.atEnd(r).to,c=$(s,i,a),l=$(o,i,a),u=m.TextSelection.create(r,c,l);t.setSelection(u)}return!0},ar=e=>({state:t,dispatch:n})=>{const r=_(e,t.schema);return m.sinkListItem(r)(t,n)};function Yt(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(s=>t==null?void 0:t.includes(s.type.name));e.tr.ensureMarks(r)}}const lr=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:s})=>{const{selection:o,doc:i}=t,{$from:a,$to:c}=o,l=s.extensionManager.attributes,u=it(l,a.node().type.name,a.node().attrs);if(o instanceof m.NodeSelection&&o.node.isBlock)return!a.parentOffset||!m.canSplit(i,a.pos)?!1:(r&&(e&&Yt(n,s.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=c.parentOffset===c.parent.content.size,p=a.depth===0?void 0:Kn(a.node(-1).contentMatchAt(a.indexAfter(-1)));let h=d&&p?[{type:p,attrs:u}]:void 0,f=m.canSplit(t.doc,t.mapping.map(a.pos),1,h);if(!h&&!f&&m.canSplit(t.doc,t.mapping.map(a.pos),1,p?[{type:p}]:void 0)&&(f=!0,h=p?[{type:p,attrs:u}]:void 0),r){if(f&&(o instanceof m.TextSelection&&t.deleteSelection(),t.split(t.mapping.map(a.pos),1,h),p&&!d&&!a.parentOffset&&a.parent.type!==p)){const g=t.mapping.map(a.before()),y=t.doc.resolve(g);a.node(-1).canReplaceWith(y.index(),y.index()+1,p)&&t.setNodeMarkup(t.mapping.map(a.before()),p)}e&&Yt(n,s.extensionManager.splittableMarks),t.scrollIntoView()}return f},cr=(e,t={})=>({tr:n,state:r,dispatch:s,editor:o})=>{var i;const a=_(e,r.schema),{$from:c,$to:l}=r.selection,u=r.selection.node;if(u&&u.isBlock||c.depth<2||!c.sameParent(l))return!1;const d=c.node(-1);if(d.type!==a)return!1;const p=o.extensionManager.attributes;if(c.parent.content.size===0&&c.node(-1).childCount===c.indexAfter(-1)){if(c.depth===2||c.node(-3).type!==a||c.index(-2)!==c.node(-2).childCount-1)return!1;if(s){let v=m.Fragment.empty;const w=c.index(-1)?1:c.index(-2)?2:3;for(let L=c.depth-w;L>=c.depth-3;L-=1)v=m.Fragment.from(c.node(L).copy(v));const M=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,b={...it(p,c.node().type.name,c.node().attrs),...t},E=((i=a.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(b))||void 0;v=v.append(m.Fragment.from(a.createAndFill(null,E)||void 0));const S=c.before(c.depth-(w-1));n.replace(S,c.after(-M),new m.Slice(v,4-w,0));let x=-1;n.doc.nodesBetween(S,n.doc.content.size,(L,T)=>{if(x>-1)return!1;L.isTextblock&&L.content.size===0&&(x=T+1)}),x>-1&&n.setSelection(m.TextSelection.near(n.doc.resolve(x))),n.scrollIntoView()}return!0}const h=l.pos===c.end()?d.contentMatchAt(0).defaultType:null,f={...it(p,d.type.name,d.attrs),...t},g={...it(p,c.node().type.name,c.node().attrs),...t};n.delete(c.pos,l.pos);const y=h?[{type:a,attrs:f},{type:h,attrs:g}]:[{type:a,attrs:f}];if(!m.canSplit(n.doc,c.pos,2))return!1;if(s){const{selection:v,storedMarks:w}=r,{splittableMarks:M}=o.extensionManager,b=w||v.$to.parentOffset&&v.$from.marks();if(n.split(c.pos,2,y).scrollIntoView(),!b||!s)return!0;const E=b.filter(S=>M.includes(S.type.name));n.ensureMarks(E)}return!0},wt=(e,t)=>{const n=vt(i=>i.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(r===void 0)return!0;const s=e.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&m.canJoin(e.doc,n.pos)&&e.join(n.pos),!0},Tt=(e,t)=>{const n=vt(i=>i.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(n.start).after(n.depth);if(r===void 0)return!0;const s=e.doc.nodeAt(r);return n.node.type===(s==null?void 0:s.type)&&m.canJoin(e.doc,r)&&e.join(r),!0},dr=(e,t,n,r={})=>({editor:s,tr:o,state:i,dispatch:a,chain:c,commands:l,can:u})=>{const{extensions:d,splittableMarks:p}=s.extensionManager,h=_(e,i.schema),f=_(t,i.schema),{selection:g,storedMarks:y}=i,{$from:v,$to:w}=g,M=v.blockRange(w),b=y||g.$to.parentOffset&&g.$from.marks();if(!M)return!1;const E=vt(S=>Ht(S.type.name,d))(g);if(M.depth>=1&&E&&M.depth-E.depth<=1){if(E.node.type===h)return l.liftListItem(f);if(Ht(E.node.type.name,d)&&h.validContent(E.node.content)&&a)return c().command(()=>(o.setNodeMarkup(E.pos,h),!0)).command(()=>wt(o,h)).command(()=>Tt(o,h)).run()}return!n||!b||!a?c().command(()=>u().wrapInList(h,r)?!0:l.clearNodes()).wrapInList(h,r).command(()=>wt(o,h)).command(()=>Tt(o,h)).run():c().command(()=>{const S=u().wrapInList(h,r),x=b.filter(L=>p.includes(L.type.name));return o.ensureMarks(x),S?!0:l.clearNodes()}).wrapInList(h,r).command(()=>wt(o,h)).command(()=>Tt(o,h)).run()},ur=(e,t={},n={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:o=!1}=n,i=z(e,r.schema);return Rt(r,i,t)?s.unsetMark(i,{extendEmptyMarkRange:o}):s.setMark(i,t)},pr=(e,t,n={})=>({state:r,commands:s})=>{const o=_(e,r.schema),i=_(t,r.schema),a=Z(r,o,n);let c;return r.selection.$anchor.sameParent(r.selection.$head)&&(c=r.selection.$anchor.parent.attrs),a?s.setNode(i,c):s.setNode(o,{...c,...n})},hr=(e,t={})=>({state:n,commands:r})=>{const s=_(e,n.schema);return Z(n,s,t)?r.lift(s):r.wrapIn(s,t)},fr=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let r=0;r<n.length;r+=1){const s=n[r];let o;if(s.spec.isInputRules&&(o=s.getState(e))){if(t){const i=e.tr,a=o.transform;for(let c=a.steps.length-1;c>=0;c-=1)i.step(a.steps[c].invert(a.docs[c]));if(o.text){const c=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,e.schema.text(o.text,c))}else i.delete(o.from,o.to)}return!0}}return!1},mr=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:r,ranges:s}=n;return r||t&&s.forEach(o=>{e.removeMark(o.$from.pos,o.$to.pos)}),!0},gr=(e,t={})=>({tr:n,state:r,dispatch:s})=>{var o;const{extendEmptyMarkRange:i=!1}=t,{selection:a}=n,c=z(e,r.schema),{$from:l,empty:u,ranges:d}=a;if(!s)return!0;if(u&&i){let{from:p,to:h}=a;const f=(o=l.marks().find(y=>y.type===c))===null||o===void 0?void 0:o.attrs,g=mt(l,c,f);g&&(p=g.from,h=g.to),n.removeMark(p,h,c)}else d.forEach(p=>{n.removeMark(p.$from.pos,p.$to.pos,c)});return n.removeStoredMark(c),!0},yr=(e,t={})=>({tr:n,state:r,dispatch:s})=>{let o=null,i=null;const a=yt(typeof e=="string"?e:e.name,r.schema);return a?(a==="node"&&(o=_(e,r.schema)),a==="mark"&&(i=z(e,r.schema)),s&&n.selection.ranges.forEach(c=>{const l=c.$from.pos,u=c.$to.pos;r.doc.nodesBetween(l,u,(d,p)=>{o&&o===d.type&&n.setNodeMarkup(p,void 0,{...d.attrs,...t}),i&&d.marks.length&&d.marks.forEach(h=>{if(i===h.type){const f=Math.max(p,l),g=Math.min(p+d.nodeSize,u);n.addMark(f,g,i.create({...h.attrs,...t}))}})})}),!0):!1},vr=(e,t={})=>({state:n,dispatch:r})=>{const s=_(e,n.schema);return m.wrapIn(s,t)(n,r)},br=(e,t={})=>({state:n,dispatch:r})=>{const s=_(e,n.schema);return m.wrapInList(s,t)(n,r)};var Mr=Object.freeze({__proto__:null,blur:Ze,clearContent:tn,clearNodes:en,command:nn,createParagraphNear:rn,cut:sn,deleteCurrentNode:on,deleteNode:an,deleteRange:ln,deleteSelection:cn,enter:dn,exitCode:un,extendMarkRange:hn,first:fn,focus:mn,forEach:gn,insertContent:yn,insertContentAt:Mn,joinBackward:wn,joinDown:kn,joinForward:Tn,joinItemBackward:En,joinItemForward:Cn,joinTextblockBackward:xn,joinTextblockForward:An,joinUp:Sn,keyboardShortcut:Ln,lift:Pn,liftEmptyBlock:Rn,liftListItem:Hn,newlineInCode:_n,resetAttributes:Dn,scrollIntoView:In,selectAll:Nn,selectNodeBackward:$n,selectNodeForward:Bn,selectParentNode:jn,selectTextblockEnd:Fn,selectTextblockStart:zn,setContent:Vn,setMark:nr,setMeta:rr,setNode:sr,setNodeSelection:or,setTextSelection:ir,sinkListItem:ar,splitBlock:lr,splitListItem:cr,toggleList:dr,toggleMark:ur,toggleNode:pr,toggleWrap:hr,undoInputRule:fr,unsetAllMarks:mr,unsetMark:gr,updateAttributes:yr,wrapIn:vr,wrapInList:br});const Sr=H.create({name:"commands",addCommands(){return{...Mr}}}),kr=H.create({name:"drop",addProseMirrorPlugins(){return[new m.Plugin({key:new m.PluginKey("tiptapDrop"),props:{handleDrop:(e,t,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:r})}}})]}}),wr=H.create({name:"editable",addProseMirrorPlugins(){return[new m.Plugin({key:new m.PluginKey("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Tr=H.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new m.Plugin({key:new m.PluginKey("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),Er=H.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:i})=>[()=>i.undoInputRule(),()=>i.command(({tr:a})=>{const{selection:c,doc:l}=a,{empty:u,$anchor:d}=c,{pos:p,parent:h}=d,f=d.parent.isTextblock&&p>0?a.doc.resolve(p-1):d,g=f.parent.type.spec.isolating,y=d.pos-d.parentOffset,v=g&&f.parent.childCount===1?y===d.pos:m.Selection.atStart(l).from===p;return!u||!h.type.isTextblock||h.textContent.length||!v||v&&d.parent.type.name==="paragraph"?!1:i.clearNodes()}),()=>i.deleteSelection(),()=>i.joinBackward(),()=>i.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:i})=>[()=>i.deleteSelection(),()=>i.deleteCurrentNode(),()=>i.joinForward(),()=>i.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:i})=>[()=>i.newlineInCode(),()=>i.createParagraphNear(),()=>i.liftEmptyBlock(),()=>i.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},o={...r,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return gt()||we()?o:s},addProseMirrorPlugins(){return[new m.Plugin({key:new m.PluginKey("clearDocument"),appendTransaction:(e,t,n)=>{const r=e.some(g=>g.docChanged)&&!t.doc.eq(n.doc),s=e.some(g=>g.getMeta("preventClearDocument"));if(!r||s)return;const{empty:o,from:i,to:a}=t.selection,c=m.Selection.atStart(t.doc).from,l=m.Selection.atEnd(t.doc).to;if(o||!(i===c&&a===l)||!bt(n.doc))return;const p=n.tr,h=dt({state:n,transaction:p}),{commands:f}=new ut({editor:this.editor,state:h});if(f.clearNodes(),!!p.steps.length)return p}})]}}),Cr=H.create({name:"paste",addProseMirrorPlugins(){return[new m.Plugin({key:new m.PluginKey("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),xr=H.create({name:"tabindex",addProseMirrorPlugins(){return[new m.Plugin({key:new m.PluginKey("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class q{get name(){return this.node.type.name}constructor(t,n,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=t,this.editor=n,this.currentNode=s}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var t;return(t=this.actualDepth)!==null&&t!==void 0?t:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(t){let n=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}n=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:n,to:r},t)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const t=this.resolvedPos.start(this.resolvedPos.depth-1),n=this.resolvedPos.doc.resolve(t);return new q(n,this.editor)}get before(){let t=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.from-3)),new q(t,this.editor)}get after(){let t=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return t.depth!==this.depth&&(t=this.resolvedPos.doc.resolve(this.to+3)),new q(t,this.editor)}get children(){const t=[];return this.node.content.forEach((n,r)=>{const s=n.isBlock&&!n.isTextblock,o=n.isAtom&&!n.isText,i=this.pos+r+(o?0:1),a=this.resolvedPos.doc.resolve(i);if(!s&&a.depth<=this.depth)return;const c=new q(a,this.editor,s,s?n:null);s&&(c.actualDepth=this.depth+1),t.push(new q(a,this.editor,s,s?n:null))}),t}get firstChild(){return this.children[0]||null}get lastChild(){const t=this.children;return t[t.length-1]||null}closest(t,n={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===t)if(Object.keys(n).length>0){const o=s.node.attrs,i=Object.keys(n);for(let a=0;a<i.length;a+=1){const c=i[a];if(o[c]!==n[c])break}}else r=s;s=s.parent}return r}querySelector(t,n={}){return this.querySelectorAll(t,n,!0)[0]||null}querySelectorAll(t,n={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const o=Object.keys(n);return this.children.forEach(i=>{r&&s.length>0||(i.node.type.name===t&&o.every(c=>n[c]===i.node.attrs[c])&&s.push(i),!(r&&s.length>0)&&(s=s.concat(i.querySelectorAll(t,n,r))))}),s}setAttribute(t){const{tr:n}=this.editor.state;n.setNodeMarkup(this.from,void 0,{...this.node.attrs,...t}),this.editor.view.dispatch(n)}}const Ar=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function Or(e,t,n){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return t&&s.setAttribute("nonce",t),s.setAttribute("data-tiptap-style",""),s.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(s),s}class Lr extends Be{constructor(t={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:n})=>{throw n},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:n,slice:r,moved:s})=>this.options.onDrop(n,r,s)),this.on("paste",({event:n,slice:r})=>this.options.onPaste(n,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=Or(Ar,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,n=!0){this.setOptions({editable:t}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,n){const r=ge(n)?n(t,[...this.state.plugins]):[...this.state.plugins,t],s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}unregisterPlugin(t){if(this.isDestroyed)return;const n=this.state.plugins;let r=n;if([].concat(t).forEach(o=>{const i=typeof o=="string"?`${o}$`:o.key;r=n.filter(a=>!a.key.startsWith(i))}),n.length===r.length)return;const s=this.state.reconfigure({plugins:r});return this.view.updateState(s),s}createExtensionManager(){var t,n;const s=[...this.options.enableCoreExtensions?[wr,Qe.configure({blockSeparator:(n=(t=this.options.coreExtensionOptions)===null||t===void 0?void 0:t.clipboardTextSerializer)===null||n===void 0?void 0:n.blockSeparator}),Sr,Tr,Er,xr,kr,Cr].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new Y(s,this)}createCommandManager(){this.commandManager=new ut({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){let t;try{t=Pt(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(o){if(!(o instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(o.message))throw o;this.emit("contentError",{editor:this,error:o,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(i=>i.name!=="collaboration"),this.createExtensionManager()}}),t=Pt(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const n=Se(t,this.options.autofocus);this.view=new m.EditorView(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:m.EditorState.create({doc:t,selection:n||void 0})}),this.view.dom.setAttribute("role","textbox"),this.view.dom.getAttribute("aria-label")||this.view.dom.setAttribute("aria-label","Rich-Text Editor");const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(i=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(i)});return}const n=this.state.apply(t),r=!this.state.selection.eq(n.selection);this.emit("beforeTransaction",{editor:this,transaction:t,nextState:n}),this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t}),r&&this.emit("selectionUpdate",{editor:this,transaction:t});const s=t.getMeta("focus"),o=t.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:t}),o&&this.emit("blur",{editor:this,event:o.event,transaction:t}),!(!t.docChanged||t.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return Ee(this.state,t)}isActive(t,n){const r=typeof t=="string"?t:null,s=typeof t=="string"?n:t;return Ce(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Gn(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n=`

`,textSerializers:r={}}=t||{};return Jn(this.state.doc,{blockSeparator:n,textSerializers:{...Me(this.schema),...r}})}get isEmpty(){return bt(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const t=this.view.dom;t&&t.editor&&delete t.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var t;return!(!((t=this.view)===null||t===void 0)&&t.docView)}$node(t,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(t,n))||null}$nodes(t,n){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(t,n))||null}$pos(t){const n=this.state.doc.resolve(t);return new q(n,this)}get $doc(){return this.$pos(0)}}function U(e){return new ht({find:e.find,handler:({state:t,range:n,match:r})=>{const s=C(e.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:o}=t,i=r[r.length-1],a=r[0];if(i){const c=a.search(/\S/),l=n.from+a.indexOf(i),u=l+i.length;if(Ft(n.from,n.to,t.doc).filter(h=>h.mark.type.excluded.find(g=>g===e.type&&g!==h.mark.type)).filter(h=>h.to>l).length)return null;u<n.to&&o.delete(u,n.to),l>n.from&&o.delete(n.from+c,l);const p=n.from+c+i.length;o.addMark(n.from+c,p,e.type.create(s||{})),o.removeStoredMark(e.type)}}})}function zt(e){return new ht({find:e.find,handler:({state:t,range:n,match:r})=>{const s=C(e.getAttributes,void 0,r)||{},{tr:o}=t,i=n.from;let a=n.to;const c=e.type.create(s);if(r[1]){const l=r[0].lastIndexOf(r[1]);let u=i+l;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,i+r[0].length-1),o.replaceWith(u,a,c)}else if(r[0]){const l=e.type.isInline?i:i-1;o.insert(l,e.type.create(s)).delete(o.mapping.map(i),o.mapping.map(a))}o.scrollIntoView()}})}function _t(e){return new ht({find:e.find,handler:({state:t,range:n,match:r})=>{const s=t.doc.resolve(n.from),o=C(e.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,o)}})}function X(e){return new ht({find:e.find,handler:({state:t,range:n,match:r,chain:s})=>{const o=C(e.getAttributes,void 0,r)||{},i=t.tr.delete(n.from,n.to),c=i.doc.resolve(n.from).blockRange(),l=c&&m.findWrapping(c,e.type,o);if(!l)return null;if(i.wrap(c,l),e.keepMarks&&e.editor){const{selection:d,storedMarks:p}=t,{splittableMarks:h}=e.editor.extensionManager,f=p||d.$to.parentOffset&&d.$from.marks();if(f){const g=f.filter(y=>h.includes(y.type.name));i.ensureMarks(g)}}if(e.keepAttributes){const d=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(d,o).run()}const u=i.doc.resolve(n.from-1).nodeBefore;u&&u.type===e.type&&m.canJoin(i.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(r,u))&&i.join(n.from-1)}})}class R{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=C(k(this,"addOptions",{name:this.name}))),this.storage=C(k(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new R(t)}configure(t={}){const n=this.extend({...this.config,addOptions:()=>ft(this.options,t)});return n.name=this.name,n.parent=this.parent,n}extend(t={}){const n=new R(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&Object.keys(t.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=C(k(n,"addOptions",{name:n.name})),n.storage=C(k(n,"addStorage",{name:n.name,options:n.options})),n}}function Pr(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}class Rr{constructor(t,n,r){this.isDragging=!1,this.component=t,this.editor=n.editor,this.options={stopEvent:null,ignoreMutation:null,...r},this.extension=n.extension,this.node=n.node,this.decorations=n.decorations,this.innerDecorations=n.innerDecorations,this.view=n.view,this.HTMLAttributes=n.HTMLAttributes,this.getPos=n.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var n,r,s,o,i,a,c;const{view:l}=this.editor,u=t.target,d=u.nodeType===3?(n=u.parentElement)===null||n===void 0?void 0:n.closest("[data-drag-handle]"):u.closest("[data-drag-handle]");if(!this.dom||!((r=this.contentDOM)===null||r===void 0)&&r.contains(u)||!d)return;let p=0,h=0;if(this.dom!==d){const v=this.dom.getBoundingClientRect(),w=d.getBoundingClientRect(),M=(s=t.offsetX)!==null&&s!==void 0?s:(o=t.nativeEvent)===null||o===void 0?void 0:o.offsetX,b=(i=t.offsetY)!==null&&i!==void 0?i:(a=t.nativeEvent)===null||a===void 0?void 0:a.offsetY;p=w.x-v.x+M,h=w.y-v.y+b}(c=t.dataTransfer)===null||c===void 0||c.setDragImage(this.dom,p,h);const f=this.getPos();if(typeof f!="number")return;const g=m.NodeSelection.create(l.state.doc,f),y=l.state.tr.setSelection(g);l.dispatch(y)}stopEvent(t){var n;if(!this.dom)return!1;if(typeof this.options.stopEvent=="function")return this.options.stopEvent({event:t});const r=t.target;if(!(this.dom.contains(r)&&!(!((n=this.contentDOM)===null||n===void 0)&&n.contains(r))))return!1;const o=t.type.startsWith("drag"),i=t.type==="drop";if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(r.tagName)||r.isContentEditable)&&!i&&!o)return!0;const{isEditable:c}=this.editor,{isDragging:l}=this,u=!!this.node.type.spec.draggable,d=m.NodeSelection.isSelectable(this.node),p=t.type==="copy",h=t.type==="paste",f=t.type==="cut",g=t.type==="mousedown";if(!u&&d&&o&&t.preventDefault(),u&&o&&!l)return t.preventDefault(),!1;if(u&&c&&!l&&g){const y=r.closest("[data-drag-handle]");y&&(this.dom===y||this.dom.contains(y))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("drop",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(l||i||p||h||f||g&&d)}ignoreMutation(t){return!this.dom||!this.contentDOM?!0:typeof this.options.ignoreMutation=="function"?this.options.ignoreMutation({mutation:t}):this.node.isLeaf||this.node.isAtom?!0:t.type==="selection"||this.dom.contains(t.target)&&t.type==="childList"&&(gt()||Pr())&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(r=>r.isContentEditable)?!1:this.contentDOM===t.target&&t.type==="attributes"?!0:!this.contentDOM.contains(t.target)}updateAttributes(t){this.editor.commands.command(({tr:n})=>{const r=this.getPos();return typeof r!="number"?!1:(n.setNodeMarkup(r,void 0,{...this.node.attrs,...t}),!0)})}deleteNode(){const t=this.getPos();if(typeof t!="number")return;const n=t+this.node.nodeSize;this.editor.commands.deleteRange({from:t,to:n})}}function F(e){return new ve({find:e.find,handler:({state:t,range:n,match:r,pasteEvent:s})=>{const o=C(e.getAttributes,void 0,r,s);if(o===!1||o===null)return null;const{tr:i}=t,a=r[r.length-1],c=r[0];let l=n.to;if(a){const u=c.search(/\S/),d=n.from+c.indexOf(a),p=d+a.length;if(Ft(n.from,n.to,t.doc).filter(f=>f.mark.type.excluded.find(y=>y===e.type&&y!==f.mark.type)).filter(f=>f.to>d).length)return null;p<n.to&&i.delete(p,n.to),d>n.from&&i.delete(n.from+u,d),l=n.from+u+a.length,i.addMark(n.from+u,l,e.type.create(o||{})),i.removeStoredMark(e.type)}}})}function Hr(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function _r(e){return new ve({find:e.find,handler({match:t,chain:n,range:r,pasteEvent:s}){const o=C(e.getAttributes,void 0,t,s),i=C(e.getContent,void 0,o);if(o===!1||o===null)return null;const a={type:e.type.name,attrs:o};i&&(a.content=i),t.input&&n().deleteRange(r).insertContentAt(r.from,a)}})}const Dr=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,Ir=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,Nr=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,$r=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,Br=D.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",O(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[U({find:Dr,type:this.type}),U({find:Nr,type:this.type})]},addPasteRules(){return[F({find:Ir,type:this.type}),F({find:$r,type:this.type})]}});class jr{constructor({editor:t,element:n,view:r,tippyOptions:s={},updateDelay:o=250,shouldShow:i}){this.preventHide=!1,this.shouldShow=({view:a,state:c,from:l,to:u})=>{const{doc:d,selection:p}=c,{empty:h}=p,f=!d.textBetween(l,u).length&&Bt(c.selection),g=this.element.contains(document.activeElement);return!(!(a.hasFocus()||g)||h||f||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var c;if(this.preventHide){this.preventHide=!1;return}a!=null&&a.relatedTarget&&(!((c=this.element.parentNode)===null||c===void 0)&&c.contains(a.relatedTarget))||this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.handleDebouncedUpdate=(a,c)=>{const l=!(c!=null&&c.selection.eq(a.state.selection)),u=!(c!=null&&c.doc.eq(a.state.doc));!l&&!u||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(a,l,u,c)},this.updateDelay))},this.updateHandler=(a,c,l,u)=>{var d,p,h;const{state:f,composing:g}=a,{selection:y}=f;if(g||!c&&!l)return;this.createTooltip();const{ranges:w}=y,M=Math.min(...w.map(S=>S.$from.pos)),b=Math.max(...w.map(S=>S.$to.pos));if(!((d=this.shouldShow)===null||d===void 0?void 0:d.call(this,{editor:this.editor,view:a,state:f,oldState:u,from:M,to:b}))){this.hide();return}(p=this.tippy)===null||p===void 0||p.setProps({getReferenceClientRect:((h=this.tippyOptions)===null||h===void 0?void 0:h.getReferenceClientRect)||(()=>{if(xe(f.selection)){let S=a.nodeDOM(M);const x=S.dataset.nodeViewWrapper?S:S.querySelector("[data-node-view-wrapper]");if(x&&(S=x.firstChild),S)return S.getBoundingClientRect()}return tr(a,M,b)})}),this.show()},this.editor=t,this.element=n,this.view=r,this.updateDelay=o,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=s,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=he(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,n){const{state:r}=t,s=r.selection.from!==r.selection.to;if(this.updateDelay>0&&s){this.handleDebouncedUpdate(t,n);return}const o=!(n!=null&&n.selection.eq(t.state.selection)),i=!(n!=null&&n.doc.eq(t.state.doc));this.updateHandler(t,o,i,n)}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,n;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const Ae=e=>new m.Plugin({key:typeof e.pluginKey=="string"?new m.PluginKey(e.pluginKey):e.pluginKey,view:t=>new jr({view:t,...e})});H.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[Ae({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});function Fr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Dt={exports:{}},Et={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xt;function zr(){if(Xt)return Et;Xt=1;var e=A;function t(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,s=e.useEffect,o=e.useLayoutEffect,i=e.useDebugValue;function a(d,p){var h=p(),f=r({inst:{value:h,getSnapshot:p}}),g=f[0].inst,y=f[1];return o(function(){g.value=h,g.getSnapshot=p,c(g)&&y({inst:g})},[d,h,p]),s(function(){return c(g)&&y({inst:g}),d(function(){c(g)&&y({inst:g})})},[d]),i(h),h}function c(d){var p=d.getSnapshot;d=d.value;try{var h=p();return!n(d,h)}catch{return!0}}function l(d,p){return p()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?l:a;return Et.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,Et}var Ct={};/**
 * @license React
 * use-sync-external-store-shim.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qt;function Vr(){return Qt||(Qt=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=A,t=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function n(M){{for(var b=arguments.length,E=new Array(b>1?b-1:0),S=1;S<b;S++)E[S-1]=arguments[S];r("error",M,E)}}function r(M,b,E){{var S=t.ReactDebugCurrentFrame,x=S.getStackAddendum();x!==""&&(b+="%s",E=E.concat([x]));var L=E.map(function(T){return String(T)});L.unshift("Warning: "+b),Function.prototype.apply.call(console[M],console,L)}}function s(M,b){return M===b&&(M!==0||1/M===1/b)||M!==M&&b!==b}var o=typeof Object.is=="function"?Object.is:s,i=e.useState,a=e.useEffect,c=e.useLayoutEffect,l=e.useDebugValue,u=!1,d=!1;function p(M,b,E){u||e.startTransition!==void 0&&(u=!0,n("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var S=b();if(!d){var x=b();o(S,x)||(n("The result of getSnapshot should be cached to avoid an infinite loop"),d=!0)}var L=i({inst:{value:S,getSnapshot:b}}),T=L[0].inst,P=L[1];return c(function(){T.value=S,T.getSnapshot=b,h(T)&&P({inst:T})},[M,S,b]),a(function(){h(T)&&P({inst:T});var N=function(){h(T)&&P({inst:T})};return M(N)},[M]),l(S),S}function h(M){var b=M.getSnapshot,E=M.value;try{var S=b();return!o(E,S)}catch{return!0}}function f(M,b,E){return b()}var g=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",y=!g,v=y?f:p,w=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:v;Ct.useSyncExternalStore=w,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),Ct}process.env.NODE_ENV==="production"?Dt.exports=zr():Dt.exports=Vr();var Mt=Dt.exports;const Wr=(...e)=>t=>{e.forEach(n=>{typeof n=="function"?n(t):n&&(n.current=t)})},Kr=({contentComponent:e})=>{const t=Mt.useSyncExternalStore(e.subscribe,e.getSnapshot,e.getServerSnapshot);return A.createElement(A.Fragment,null,Object.values(t))};function qr(){const e=new Set;let t={};return{subscribe(n){return e.add(n),()=>{e.delete(n)}},getSnapshot(){return t},getServerSnapshot(){return t},setRenderer(n,r){t={...t,[n]:fe.createPortal(r.reactElement,r.element,n)},e.forEach(s=>s())},removeRenderer(n){const r={...t};delete r[n],t=r,e.forEach(s=>s())}}}class Ur extends A.Component{constructor(t){var n;super(t),this.editorContentRef=A.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((n=t.editor)===null||n===void 0)&&n.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const t=this.props.editor;if(t&&!t.isDestroyed&&t.options.element){if(t.contentComponent)return;const n=this.editorContentRef.current;n.append(...t.options.element.childNodes),t.setOptions({element:n}),t.contentComponent=qr(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=t.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),t.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const t=this.props.editor;if(!t||(this.initialized=!1,t.isDestroyed||t.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),t.contentComponent=null,!t.options.element.firstChild))return;const n=document.createElement("div");n.append(...t.options.element.childNodes),t.setOptions({element:n})}render(){const{editor:t,innerRef:n,...r}=this.props;return A.createElement(A.Fragment,null,A.createElement("div",{ref:Wr(n,this.editorContentRef),...r}),(t==null?void 0:t.contentComponent)&&A.createElement(Kr,{contentComponent:t.contentComponent}))}}const Gr=A.forwardRef((e,t)=>{const n=A.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[e.editor]);return A.createElement(Ur,{key:n,innerRef:t,...e})}),Jr=A.memo(Gr);var Yr=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var r,s,o;if(Array.isArray(t)){if(r=t.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!e(t[s],n[s]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(s of t.entries())if(!n.has(s[0]))return!1;for(s of t.entries())if(!e(s[1],n.get(s[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(s of t.entries())if(!n.has(s[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if(r=t.length,r!=n.length)return!1;for(s=r;s--!==0;)if(t[s]!==n[s])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(o=Object.keys(t),r=o.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[s]))return!1;for(s=r;s--!==0;){var i=o[s];if(!(i==="_owner"&&t.$$typeof)&&!e(t[i],n[i]))return!1}return!0}return t!==t&&n!==n},Xr=Fr(Yr),It={exports:{}},xt={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zt;function Qr(){if(Zt)return xt;Zt=1;var e=A,t=Mt;function n(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var r=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,o=e.useRef,i=e.useEffect,a=e.useMemo,c=e.useDebugValue;return xt.useSyncExternalStoreWithSelector=function(l,u,d,p,h){var f=o(null);if(f.current===null){var g={hasValue:!1,value:null};f.current=g}else g=f.current;f=a(function(){function v(S){if(!w){if(w=!0,M=S,S=p(S),h!==void 0&&g.hasValue){var x=g.value;if(h(x,S))return b=x}return b=S}if(x=b,r(M,S))return x;var L=p(S);return h!==void 0&&h(x,L)?x:(M=S,b=L)}var w=!1,M,b,E=d===void 0?null:d;return[function(){return v(u())},E===null?void 0:function(){return v(E())}]},[u,d,p,h]);var y=s(l,f[0],f[1]);return i(function(){g.hasValue=!0,g.value=y},[y]),c(y),y},xt}var At={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var te;function Zr(){return te||(te=1,process.env.NODE_ENV!=="production"&&function(){typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(new Error);var e=A,t=Mt;function n(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var r=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,o=e.useRef,i=e.useEffect,a=e.useMemo,c=e.useDebugValue;function l(u,d,p,h,f){var g=o(null),y;g.current===null?(y={hasValue:!1,value:null},g.current=y):y=g.current;var v=a(function(){var E=!1,S,x,L=function(B){if(!E){E=!0,S=B;var G=h(B);if(f!==void 0&&y.hasValue){var V=y.value;if(f(V,G))return x=V,V}return x=G,G}var W=S,j=x;if(r(W,B))return j;var K=h(B);return f!==void 0&&f(j,K)?j:(S=B,x=K,K)},T=p===void 0?null:p,P=function(){return L(d())},N=T===null?void 0:function(){return L(T())};return[P,N]},[d,p,h,f]),w=v[0],M=v[1],b=s(u,w,M);return i(function(){y.hasValue=!0,y.value=b},[b]),c(b),b}At.useSyncExternalStoreWithSelector=l,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(new Error)}()),At}process.env.NODE_ENV==="production"?It.exports=Qr():It.exports=Zr();var ts=It.exports;class es{constructor(t){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=t,this.lastSnapshot={editor:t,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(t){return this.subscribers.add(t),()=>{this.subscribers.delete(t)}}watch(t){if(this.editor=t,this.editor){const n=()=>{this.transactionNumber+=1,this.subscribers.forEach(s=>s())},r=this.editor;return r.on("transaction",n),()=>{r.off("transaction",n)}}}}function ns(e){var t;const[n]=A.useState(()=>new es(e.editor)),r=ts.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,e.selector,(t=e.equalityFn)!==null&&t!==void 0?t:Xr);return A.useEffect(()=>n.watch(e.editor),[e.editor,n]),A.useDebugValue(r),r}const ee=process.env.NODE_ENV!=="production",Nt=typeof window>"u",rs=Nt||!!(typeof window<"u"&&window.next);class ss{constructor(t){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=t,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(t){this.editor=t,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(n=>n())}getInitialEditor(){if(this.options.current.immediatelyRender===void 0)return Nt||rs?(ee&&console.warn("Tiptap Error: SSR has been detected, please set `immediatelyRender` explicitly to `false` to avoid hydration mismatches."),null):this.createEditor();if(this.options.current.immediatelyRender&&Nt&&ee)throw new Error("Tiptap Error: SSR has been detected, and `immediatelyRender` has been set to `true` this is an unsupported configuration that may result in errors, explicitly set `immediatelyRender` to `false` to avoid hydration mismatches.");return this.options.current.immediatelyRender?this.createEditor():null}createEditor(){const t={...this.options.current,onBeforeCreate:(...r)=>{var s,o;return(o=(s=this.options.current).onBeforeCreate)===null||o===void 0?void 0:o.call(s,...r)},onBlur:(...r)=>{var s,o;return(o=(s=this.options.current).onBlur)===null||o===void 0?void 0:o.call(s,...r)},onCreate:(...r)=>{var s,o;return(o=(s=this.options.current).onCreate)===null||o===void 0?void 0:o.call(s,...r)},onDestroy:(...r)=>{var s,o;return(o=(s=this.options.current).onDestroy)===null||o===void 0?void 0:o.call(s,...r)},onFocus:(...r)=>{var s,o;return(o=(s=this.options.current).onFocus)===null||o===void 0?void 0:o.call(s,...r)},onSelectionUpdate:(...r)=>{var s,o;return(o=(s=this.options.current).onSelectionUpdate)===null||o===void 0?void 0:o.call(s,...r)},onTransaction:(...r)=>{var s,o;return(o=(s=this.options.current).onTransaction)===null||o===void 0?void 0:o.call(s,...r)},onUpdate:(...r)=>{var s,o;return(o=(s=this.options.current).onUpdate)===null||o===void 0?void 0:o.call(s,...r)},onContentError:(...r)=>{var s,o;return(o=(s=this.options.current).onContentError)===null||o===void 0?void 0:o.call(s,...r)},onDrop:(...r)=>{var s,o;return(o=(s=this.options.current).onDrop)===null||o===void 0?void 0:o.call(s,...r)},onPaste:(...r)=>{var s,o;return(o=(s=this.options.current).onPaste)===null||o===void 0?void 0:o.call(s,...r)}};return new Lr(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(t){return this.subscriptions.add(t),()=>{this.subscriptions.delete(t)}}onRender(t){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&t.length===0?this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(t),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(t){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=t;return}if(this.previousDeps.length===t.length&&this.previousDeps.every((r,s)=>r===t[s]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=t}scheduleDestroy(){const t=this.instanceId,n=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===t){n&&n.setOptions(this.options.current);return}n&&!n.isDestroyed&&(n.destroy(),this.instanceId===t&&this.setEditor(null))},1)}}function os(e={},t=[]){const n=A.useRef(e);n.current=e;const[r]=A.useState(()=>new ss(n)),s=Mt.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return A.useDebugValue(s),A.useEffect(r.onRender(t)),ns({editor:s,selector:({transactionNumber:o})=>e.shouldRerenderOnTransaction===!1?null:e.immediatelyRender&&o===0?0:o+1}),s}const Oe=A.createContext({editor:null});Oe.Consumer;const is=()=>A.useContext(Oe),as=e=>{const[t,n]=A.useState(null),{editor:r}=is();return A.useEffect(()=>{var s;if(!t||!((s=e.editor)===null||s===void 0)&&s.isDestroyed||r!=null&&r.isDestroyed)return;const{pluginKey:o="bubbleMenu",editor:i,tippyOptions:a={},updateDelay:c,shouldShow:l=null}=e,u=i||r;if(!u){console.warn("BubbleMenu component is not rendered inside of an editor component or does not have editor prop.");return}const d=Ae({updateDelay:c,editor:u,element:t,pluginKey:o,shouldShow:l,tippyOptions:a});return u.registerPlugin(d),()=>{u.unregisterPlugin(o)}},[e.editor,r,t]),A.createElement("div",{ref:n,className:e.className,style:{visibility:"hidden"}},e.children)},Le=A.createContext({onDragStart:void 0}),Pe=()=>A.useContext(Le),ls=e=>{const t=e.as||"div",{nodeViewContentRef:n}=Pe();return A.createElement(t,{...e,ref:n,"data-node-view-content":"",style:{whiteSpace:"pre-wrap",...e.style}})},cs=A.forwardRef((e,t)=>{const{onDragStart:n}=Pe(),r=e.as||"div";return A.createElement(r,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})});function ds(e){return!!(typeof e=="function"&&e.prototype&&e.prototype.isReactComponent)}function us(e){var t;return typeof e=="object"&&((t=e.$$typeof)===null||t===void 0?void 0:t.toString())==="Symbol(react.forward_ref)"}class Re{constructor(t,{editor:n,props:r={},as:s="div",className:o=""}){this.ref=null,this.id=Math.floor(Math.random()*4294967295).toString(),this.component=t,this.editor=n,this.props=r,this.element=document.createElement(s),this.element.classList.add("react-renderer"),o&&this.element.classList.add(...o.split(" ")),this.editor.isInitialized?fe.flushSync(()=>{this.render()}):this.render()}render(){var t;const n=this.component,r=this.props,s=this.editor;(ds(n)||us(n))&&(r.ref=o=>{this.ref=o}),this.reactElement=A.createElement(n,r),(t=s==null?void 0:s.contentComponent)===null||t===void 0||t.setRenderer(this.id,this)}updateProps(t={}){this.props={...this.props,...t},this.render()}destroy(){var t;const n=this.editor;(t=n==null?void 0:n.contentComponent)===null||t===void 0||t.removeRenderer(this.id)}updateAttributes(t){Object.keys(t).forEach(n=>{this.element.setAttribute(n,t[n])})}}class ps extends Rr{mount(){const t={editor:this.editor,node:this.node,decorations:this.decorations,innerDecorations:this.innerDecorations,view:this.view,selected:!1,extension:this.extension,HTMLAttributes:this.HTMLAttributes,getPos:()=>this.getPos(),updateAttributes:(l={})=>this.updateAttributes(l),deleteNode:()=>this.deleteNode()};if(!this.component.displayName){const l=u=>u.charAt(0).toUpperCase()+u.substring(1);this.component.displayName=l(this.extension.name)}const s={onDragStart:this.onDragStart.bind(this),nodeViewContentRef:l=>{l&&this.contentDOMElement&&l.firstChild!==this.contentDOMElement&&l.appendChild(this.contentDOMElement)}},o=this.component,i=A.memo(l=>A.createElement(Le.Provider,{value:s},A.createElement(o,l)));i.displayName="ReactNodeView",this.node.isLeaf?this.contentDOMElement=null:this.options.contentDOMElementTag?this.contentDOMElement=document.createElement(this.options.contentDOMElementTag):this.contentDOMElement=document.createElement(this.node.isInline?"span":"div"),this.contentDOMElement&&(this.contentDOMElement.dataset.nodeViewContentReact="",this.contentDOMElement.style.whiteSpace="inherit");let a=this.node.isInline?"span":"div";this.options.as&&(a=this.options.as);const{className:c=""}=this.options;this.handleSelectionUpdate=this.handleSelectionUpdate.bind(this),this.editor.on("selectionUpdate",this.handleSelectionUpdate),this.renderer=new Re(i,{editor:this.editor,props:t,as:a,className:`node-${this.node.type.name} ${c}`.trim()}),this.updateElementAttributes()}get dom(){var t;if(this.renderer.element.firstElementChild&&!(!((t=this.renderer.element.firstElementChild)===null||t===void 0)&&t.hasAttribute("data-node-view-wrapper")))throw Error("Please use the NodeViewWrapper component for your node view.");return this.renderer.element}get contentDOM(){return this.node.isLeaf?null:this.contentDOMElement}handleSelectionUpdate(){const{from:t,to:n}=this.editor.state.selection,r=this.getPos();if(typeof r=="number")if(t<=r&&n>=r+this.node.nodeSize){if(this.renderer.props.selected)return;this.selectNode()}else{if(!this.renderer.props.selected)return;this.deselectNode()}}update(t,n,r){const s=o=>{this.renderer.updateProps(o),typeof this.options.attrs=="function"&&this.updateElementAttributes()};if(t.type!==this.node.type)return!1;if(typeof this.options.update=="function"){const o=this.node,i=this.decorations,a=this.innerDecorations;return this.node=t,this.decorations=n,this.innerDecorations=r,this.options.update({oldNode:o,oldDecorations:i,newNode:t,newDecorations:n,oldInnerDecorations:a,innerDecorations:r,updateProps:()=>s({node:t,decorations:n,innerDecorations:r})})}return t===this.node&&this.decorations===n&&this.innerDecorations===r||(this.node=t,this.decorations=n,this.innerDecorations=r,s({node:t,decorations:n,innerDecorations:r})),!0}selectNode(){this.renderer.updateProps({selected:!0}),this.renderer.element.classList.add("ProseMirror-selectednode")}deselectNode(){this.renderer.updateProps({selected:!1}),this.renderer.element.classList.remove("ProseMirror-selectednode")}destroy(){this.renderer.destroy(),this.editor.off("selectionUpdate",this.handleSelectionUpdate),this.contentDOMElement=null}updateElementAttributes(){if(this.options.attrs){let t={};if(typeof this.options.attrs=="function"){const n=this.editor.extensionManager.attributes,r=at(this.node,n);t=this.options.attrs({node:this.node,HTMLAttributes:r})}else t=this.options.attrs;this.renderer.updateAttributes(t)}}}function hs(e,t){return n=>n.editor.contentComponent?new ps(e,n,t):{}}function Vt(e,t,n){const r=[],s=e.node(0);n=typeof n=="number"&&n>=0?n:e.sameParent(t)?Math.max(0,e.sharedDepth(t.pos)-1):e.sharedDepth(t.pos);const o=new m.NodeRange(e,t,n),i=o.depth===0?0:s.resolve(o.start).posAtIndex(0);return o.parent.forEach((a,c)=>{const l=i+c,u=l+a.nodeSize;if(l<o.start||l>=o.end)return;const d=new m.SelectionRange(s.resolve(l),s.resolve(u));r.push(d)}),r}class Wt{constructor(t,n){tt(this,"anchor");tt(this,"head");this.anchor=t,this.head=n}map(t){return new Wt(t.map(this.anchor),t.map(this.head))}resolve(t){const n=t.resolve(this.anchor),r=t.resolve(this.head);return new I(n,r)}}class I extends m.Selection{constructor(n,r,s,o=1){const{doc:i}=n,a=n===r,c=n.pos===i.content.size&&r.pos===i.content.size,l=a&&!c?i.resolve(r.pos+(o>0?1:-1)):r,u=a&&c?i.resolve(n.pos-(o>0?1:-1)):n,d=Vt(u.min(l),u.max(l),s);super(l.pos>=n.pos?d[0].$from:d[d.length-1].$to,l.pos>=n.pos?d[d.length-1].$to:d[0].$from,d);tt(this,"depth");this.depth=s}get $to(){return this.ranges[this.ranges.length-1].$to}eq(n){return n instanceof I&&n.$from.pos===this.$from.pos&&n.$to.pos===this.$to.pos}map(n,r){const s=n.resolve(r.map(this.anchor)),o=n.resolve(r.map(this.head));return new I(s,o)}toJSON(){return{type:"nodeRange",anchor:this.anchor,head:this.head}}get isForwards(){return this.head>=this.anchor}get isBackwards(){return!this.isForwards}extendBackwards(){const{doc:n}=this.$from;if(this.isForwards&&this.ranges.length>1){const o=this.ranges.slice(0,-1),i=o[0].$from,a=o[o.length-1].$to;return new I(i,a,this.depth)}const r=this.ranges[0],s=n.resolve(Math.max(0,r.$from.pos-1));return new I(this.$anchor,s,this.depth)}extendForwards(){const{doc:n}=this.$from;if(this.isBackwards&&this.ranges.length>1){const o=this.ranges.slice(1),i=o[0].$from,a=o[o.length-1].$to;return new I(a,i,this.depth)}const r=this.ranges[this.ranges.length-1],s=n.resolve(Math.min(n.content.size,r.$to.pos+1));return new I(this.$anchor,s,this.depth)}static fromJSON(n,r){return new I(n.resolve(r.anchor),n.resolve(r.head))}static create(n,r,s,o,i=1){return new this(n.resolve(r),n.resolve(s),o,i)}getBookmark(){return new Wt(this.anchor,this.head)}}function fs(e){const t=e.cloneNode(!0),n=[e,...Array.from(e.getElementsByTagName("*"))],r=[t,...Array.from(t.getElementsByTagName("*"))];return n.forEach((s,o)=>{r[o].style.cssText=function(i){let a="";const c=getComputedStyle(i);for(let l=0;l<c.length;l+=1)a+=`${c[l]}:${c.getPropertyValue(c[l])};`;return a}(s)}),t}function st(e,t){return window.getComputedStyle(e)[t]}function ms(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function ne(e){e.parentNode!==null&&e.parentNode!==void 0&&e.parentNode.removeChild(e)}const He=e=>{const{x:t,y:n,direction:r,editor:s}=e;let o=null,i=null,a=null,c=t;for(;i===null&&c<window.innerWidth&&c>0;){const l=document.elementsFromPoint(c,n),u=l.findIndex(p=>p.classList.contains("ProseMirror")),d=l.slice(0,u);if(d.length>0){const p=d[0];if(o=p,a=s.view.posAtDOM(p,0),a>=0){i=s.state.doc.nodeAt(Math.max(a-1,0)),(i===null||i.isText)&&(i=s.state.doc.nodeAt(Math.max(a-1,0))),i||(i=s.state.doc.nodeAt(Math.max(a,0)));break}}r==="left"?c-=1:c+=1}return{resultElement:o,resultNode:i,pos:a!==null?a:null}};function gs(e,t){const{doc:n}=t.view.state,r=He({editor:t,x:e.clientX,y:e.clientY,direction:"right"});if(!r.resultNode||r.pos===null)return[];const s=e.clientX,o=function(u,d,p){const h=parseInt(st(u.dom,"paddingLeft"),10),f=parseInt(st(u.dom,"paddingRight"),10),g=parseInt(st(u.dom,"borderLeftWidth"),10),y=parseInt(st(u.dom,"borderLeftWidth"),10),v=u.dom.getBoundingClientRect();return{left:ms(d,v.left+h+g,v.right-f-y),top:p}}(t.view,s,e.clientY),i=t.view.posAtCoords(o);if(!i)return[];const{pos:a}=i;if(!n.resolve(a).parent)return[];const c=n.resolve(r.pos),l=n.resolve(r.pos+1);return Vt(c,l,0)}const re=(e,t)=>{const n=e.resolve(t),{depth:r}=n;return r===0?t:n.pos-n.parentOffset-1},se=(e,t)=>{const n=e.nodeAt(t),r=e.resolve(t);let{depth:s}=r,o=n;for(;s>0;){const i=r.node(s);s-=1,s===0&&(o=i)}return o},Ot=(e,t)=>{const n=m.ySyncPluginKey.getState(e);return n?m.absolutePositionToRelativePosition(t,n.type,n.binding.mapping):null},oe=(e,t)=>{let n=t;for(;n&&n.parentNode&&n.parentNode!==e.dom;)n=n.parentNode;return n},_e=new m.PluginKey("dragHandle"),ys=({pluginKey:e=_e,element:t,editor:n,tippyOptions:r,onNodeChange:s})=>{const o=document.createElement("div");let i=null,a=!1,c=null,l=-1;return t.addEventListener("dragstart",u=>{const{view:d}=n;if(!u.dataTransfer)return;const{empty:p,$from:h,$to:f}=d.state.selection,g=gs(u,n),y=Vt(h,f,0),v=y.some(T=>g.find(P=>P.$from===T.$from&&P.$to===T.$to)),w=p||!v?g:y;if(!w.length)return;const{tr:M}=d.state,b=document.createElement("div"),E=w[0].$from.pos,S=w[w.length-1].$to.pos,x=I.create(d.state.doc,E,S),L=x.content();w.forEach(T=>{const P=fs(d.nodeDOM(T.$from.pos));b.append(P)}),b.style.position="absolute",b.style.top="-10000px",document.body.append(b),u.dataTransfer.clearData(),u.dataTransfer.setDragImage(b,0,0),d.dragging={slice:L,move:!0},M.setSelection(x),d.dispatch(M),document.addEventListener("drop",()=>ne(b),{once:!0}),setTimeout(()=>{t&&(t.style.pointerEvents="none")},0)}),t.addEventListener("dragend",()=>{t&&(t.style.pointerEvents="auto")}),new m.Plugin({key:typeof e=="string"?new m.PluginKey(e):e,state:{init:()=>({locked:!1}),apply(u,d,p,h){const f=u.getMeta("lockDragHandle"),g=u.getMeta("hideDragHandle");if(f!==void 0&&(a=f),g&&i)return i.hide(),a=!1,c=null,l=-1,s==null||s({editor:n,node:null,pos:-1}),d;if(u.docChanged&&l!==-1&&t&&i){const y=u.mapping.map(l);y!==l&&(l=y,Ot(h,l))}return d}},view:u=>{var d;return t.draggable=!0,t.style.pointerEvents="auto",(d=n.view.dom.parentElement)===null||d===void 0||d.appendChild(o),o.appendChild(t),o.style.pointerEvents="none",o.style.position="absolute",o.style.top="0",o.style.left="0",i=he(u.dom,{getReferenceClientRect:null,interactive:!0,trigger:"manual",placement:"left-start",hideOnClick:!1,duration:100,zIndex:10,popperOptions:{modifiers:[{name:"flip",enabled:!1},{name:"preventOverflow",options:{rootBoundary:"document",mainAxis:!1}}]},...r,appendTo:o,content:t}),{update(p,h){if(!t||!i||(t.draggable=!a,u.state.doc.eq(h.doc)||l===-1))return;let f=u.nodeDOM(l);if(f=oe(u,f),f===u.dom||(f==null?void 0:f.nodeType)!==1)return;const g=u.posAtDOM(f,0),y=se(n.state.doc,g);if(y!==c){const v=re(n.state.doc,g);c=y,l=v,Ot(u.state,l),s==null||s({editor:n,node:c,pos:l}),i.setProps({getReferenceClientRect:()=>f.getBoundingClientRect()}),i.show()}},destroy(){i==null||i.destroy(),t&&ne(o)}}},props:{handleDOMEvents:{mouseleave:(u,d)=>(a||d.target&&!o.contains(d.relatedTarget)&&(i==null||i.hide(),c=null,l=-1,s==null||s({editor:n,node:null,pos:-1})),!1),mousemove(u,d){if(!t||!i||a)return!1;const p=He({x:d.clientX,y:d.clientY,direction:"right",editor:n});if(!p.resultElement)return!1;let h=p.resultElement;if(h=oe(u,h),h===u.dom||(h==null?void 0:h.nodeType)!==1)return!1;const f=u.posAtDOM(h,0),g=se(n.state.doc,f);if(g!==c){const y=re(n.state.doc,f);c=g,l=y,Ot(u.state,l),s==null||s({editor:n,node:c,pos:l}),i.setProps({getReferenceClientRect:()=>h.getBoundingClientRect()}),i.show()}return!1}}}})},vs=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,bs=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,Ms=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,Ss=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,ks=D.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",O(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[U({find:vs,type:this.type}),U({find:Ms,type:this.type})]},addPasteRules(){return[F({find:bs,type:this.type}),F({find:Ss,type:this.type})]}}),ws=D.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",O(this.options.HTMLAttributes,e),0]},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),Ts=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Es=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,Cs=D.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",O(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[U({find:Ts,type:this.type})]},addPasteRules(){return[F({find:Es,type:this.type})]}}),xs=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))$/,As=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))/g,Os=D.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",O(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[U({find:xs,type:this.type})]},addPasteRules(){return[F({find:As,type:this.type})]}}),Ls=/^```([a-z]+)?[\s\n]$/,Ps=/^~~~([a-z]+)?[\s\n]$/,Rs=R.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,o=[...((t=e.firstElementChild)===null||t===void 0?void 0:t.classList)||[]].filter(i=>i.startsWith(n)).map(i=>i.replace(n,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",O(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:r,empty:s}=n;if(!s||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,i=r.parent.textContent.endsWith(`

`);return!o||!i?!1:e.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:r}=t,{$from:s,empty:o}=n;if(!o||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0?!1:r.nodeAt(a)?e.commands.command(({tr:l})=>(l.setSelection(m.Selection.near(r.resolve(a))),!0)):e.commands.exitCode()}}},addInputRules(){return[_t({find:Ls,type:this.type,getAttributes:e=>({language:e[1]})}),_t({find:Ps,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new m.Plugin({key:new m.PluginKey("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,o=s==null?void 0:s.mode;if(!n||!o)return!1;const{tr:i,schema:a}=e.state,c=a.text(n.replace(/\r\n?/g,`
`));return i.replaceSelectionWith(this.type.create({language:o},c)),i.selection.$from.parent.type!==this.type&&i.setSelection(m.TextSelection.near(i.doc.resolve(Math.max(0,i.selection.from-2)))),i.setMeta("paste",!0),e.dispatch(i),!0}}})]}}),Hs=D.create({name:"textStyle",priority:101,addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",O(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=jt(e,this.type);return Object.entries(n).some(([,s])=>!!s)?!0:t.unsetMark(this.name)}}}}),_s=H.create({name:"fontFamily",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontFamily:{default:null,parseHTML:e=>{var t;return(t=e.style.fontFamily)===null||t===void 0?void 0:t.replace(/['"]+/g,"")},renderHTML:e=>e.fontFamily?{style:`font-family: ${e.fontFamily}`}:{}}}}]},addCommands(){return{setFontFamily:e=>({chain:t})=>t().setMark("textStyle",{fontFamily:e}).run(),unsetFontFamily:()=>({chain:e})=>e().setMark("textStyle",{fontFamily:null}).removeEmptyTextStyle().run()}}}),Ds=R.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,O(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>_t({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),Is=H.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>{const t=e.style.textAlign||this.options.defaultAlignment;return this.options.alignments.includes(t)?t:this.options.defaultAlignment},renderHTML:e=>e.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${e.textAlign}`}}}}]},addCommands(){return{setTextAlign:e=>({commands:t})=>this.options.alignments.includes(e)?this.options.types.map(n=>t.updateAttributes(n,{textAlign:e})).every(n=>n):!1,unsetTextAlign:()=>({commands:e})=>this.options.types.map(t=>e.resetAttributes(t,"textAlign")).every(t=>t)}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),Ns=H.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:e=>{var t;return(t=e.style.color)===null||t===void 0?void 0:t.replace(/['"]+/g,"")},renderHTML:e=>e.color?{style:`color: ${e.color}`}:{}}}}]},addCommands(){return{setColor:e=>({chain:t})=>t().setMark("textStyle",{color:e}).run(),unsetColor:()=>({chain:e})=>e().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),$s=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))$/,Bs=/(?:^|\s)(==(?!\s+==)((?:[^=]+))==(?!\s+==))/g,js=D.create({name:"highlight",addOptions(){return{multicolor:!1,HTMLAttributes:{}}},addAttributes(){return this.options.multicolor?{color:{default:null,parseHTML:e=>e.getAttribute("data-color")||e.style.backgroundColor,renderHTML:e=>e.color?{"data-color":e.color,style:`background-color: ${e.color}; color: inherit`}:{}}}:{}},parseHTML(){return[{tag:"mark"}]},renderHTML({HTMLAttributes:e}){return["mark",O(this.options.HTMLAttributes,e),0]},addCommands(){return{setHighlight:e=>({commands:t})=>t.setMark(this.name,e),toggleHighlight:e=>({commands:t})=>t.toggleMark(this.name,e),unsetHighlight:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-h":()=>this.editor.commands.toggleHighlight()}},addInputRules(){return[U({find:$s,type:this.type})]},addPasteRules(){return[F({find:Bs,type:this.type})]}}),Fs="listItem",ie="textStyle",ae=/^\s*([-+*])\s$/,zs=R.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",O(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Fs,this.editor.getAttributes(ie)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=X({find:ae,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=X({find:ae,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(ie),editor:this.editor})),[e]}}),Vs="listItem",le="textStyle",ce=/^(\d+)\.\s$/,Ws=R.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:void 0,parseHTML:e=>e.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return t===1?["ol",O(this.options.HTMLAttributes,n),0]:["ol",O(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Vs,this.editor.getAttributes(le)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=X({find:ce,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=X({find:ce,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(le)}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1],editor:this.editor})),[e]}}),Ks=/^\s*(\[([( |x])?\])\s$/,qs=R.create({name:"taskItem",addOptions(){return{nested:!1,HTMLAttributes:{},taskListTypeName:"taskList"}},content(){return this.options.nested?"paragraph block*":"paragraph+"},defining:!0,addAttributes(){return{checked:{default:!1,keepOnSplit:!1,parseHTML:e=>{const t=e.getAttribute("data-checked");return t===""||t==="true"},renderHTML:e=>({"data-checked":e.checked})}}},parseHTML(){return[{tag:`li[data-type="${this.name}"]`,priority:51}]},renderHTML({node:e,HTMLAttributes:t}){return["li",O(this.options.HTMLAttributes,t,{"data-type":this.name}),["label",["input",{type:"checkbox",checked:e.attrs.checked?"checked":null}],["span"]],["div",0]]},addKeyboardShortcuts(){const e={Enter:()=>this.editor.commands.splitListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)};return this.options.nested?{...e,Tab:()=>this.editor.commands.sinkListItem(this.name)}:e},addNodeView(){return({node:e,HTMLAttributes:t,getPos:n,editor:r})=>{const s=document.createElement("li"),o=document.createElement("label"),i=document.createElement("span"),a=document.createElement("input"),c=document.createElement("div");return o.contentEditable="false",a.type="checkbox",a.addEventListener("mousedown",l=>l.preventDefault()),a.addEventListener("change",l=>{if(!r.isEditable&&!this.options.onReadOnlyChecked){a.checked=!a.checked;return}const{checked:u}=l.target;r.isEditable&&typeof n=="function"&&r.chain().focus(void 0,{scrollIntoView:!1}).command(({tr:d})=>{const p=n();if(typeof p!="number")return!1;const h=d.doc.nodeAt(p);return d.setNodeMarkup(p,void 0,{...h==null?void 0:h.attrs,checked:u}),!0}).run(),!r.isEditable&&this.options.onReadOnlyChecked&&(this.options.onReadOnlyChecked(e,u)||(a.checked=!a.checked))}),Object.entries(this.options.HTMLAttributes).forEach(([l,u])=>{s.setAttribute(l,u)}),s.dataset.checked=e.attrs.checked,e.attrs.checked&&a.setAttribute("checked","checked"),o.append(a,i),s.append(o,c),Object.entries(t).forEach(([l,u])=>{s.setAttribute(l,u)}),{dom:s,contentDOM:c,update:l=>l.type!==this.type?!1:(s.dataset.checked=l.attrs.checked,l.attrs.checked?a.setAttribute("checked","checked"):a.removeAttribute("checked"),!0)}}},addInputRules(){return[X({find:Ks,type:this.type,getAttributes:e=>({checked:e[e.length-1]==="x"})})]}}),Us=R.create({name:"taskList",addOptions(){return{itemTypeName:"taskItem",HTMLAttributes:{}}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:`ul[data-type="${this.name}"]`,priority:51}]},renderHTML({HTMLAttributes:e}){return["ul",O(this.options.HTMLAttributes,e,{"data-type":this.name}),0]},addCommands(){return{toggleTaskList:()=>({commands:e})=>e.toggleList(this.name,this.options.itemTypeName)}},addKeyboardShortcuts(){return{"Mod-Shift-9":()=>this.editor.commands.toggleTaskList()}}}),Gs=/^\s*>\s$/,Js=R.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return["blockquote",O(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[X({find:Gs,type:this.type})]}});function Ys(e){return e.length===1?e[0].isLink:e.length===3&&e[1].isLink?["()","[]"].includes(e[0].value+e[2].value):!1}function Xs(e){return new m.Plugin({key:new m.PluginKey("autolink"),appendTransaction:(t,n,r)=>{const s=t.some(l=>l.docChanged)&&!n.doc.eq(r.doc),o=t.some(l=>l.getMeta("preventAutolink"));if(!s||o)return;const{tr:i}=r,a=Wn(n.doc,[...t]);if(Zn(a).forEach(({newRange:l})=>{const u=Un(r.doc,l,h=>h.isTextblock);let d,p;if(u.length>1?(d=u[0],p=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ")):u.length&&r.doc.textBetween(l.from,l.to," "," ").endsWith(" ")&&(d=u[0],p=r.doc.textBetween(d.pos,l.to,void 0," ")),d&&p){const h=p.split(" ").filter(v=>v!=="");if(h.length<=0)return!1;const f=h[h.length-1],g=d.pos+p.lastIndexOf(f);if(!f)return!1;const y=m.tokenize(f).map(v=>v.toObject(e.defaultProtocol));if(!Ys(y))return!1;y.filter(v=>v.isLink).map(v=>({...v,from:g+v.start+1,to:g+v.end+1})).filter(v=>r.schema.marks.code?!r.doc.rangeHasMark(v.from,v.to,r.schema.marks.code):!0).filter(v=>e.validate(v.value)).forEach(v=>{Ft(v.from,v.to,r.doc).some(w=>w.mark.type===e.type)||i.addMark(v.from,v.to,e.type.create({href:v.href}))})}}),!!i.steps.length)return i}})}function Qs(e){return new m.Plugin({key:new m.PluginKey("handleClickLink"),props:{handleClick:(t,n,r)=>{var s,o;if(r.button!==0||!t.editable)return!1;let i=r.target;const a=[];for(;i.nodeName!=="DIV";)a.push(i),i=i.parentNode;if(!a.find(p=>p.nodeName==="A"))return!1;const c=Ee(t.state,e.type.name),l=r.target,u=(s=l==null?void 0:l.href)!==null&&s!==void 0?s:c.href,d=(o=l==null?void 0:l.target)!==null&&o!==void 0?o:c.target;return l&&u?(window.open(u,d),!0):!1}}})}function Zs(e){return new m.Plugin({key:new m.PluginKey("handlePasteLink"),props:{handlePaste:(t,n,r)=>{const{state:s}=t,{selection:o}=s,{empty:i}=o;if(i)return!1;let a="";r.content.forEach(l=>{a+=l.textContent});const c=m.find(a,{defaultProtocol:e.defaultProtocol}).find(l=>l.isLink&&l.value===a);return!a||!c?!1:(e.editor.commands.setMark(e.type,{href:c.href}),!0)}}})}const to=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g;function de(e,t){const n=["http","https","ftp","ftps","mailto","tel","callto","sms","cid","xmpp"];return t&&t.forEach(r=>{const s=typeof r=="string"?r:r.scheme;s&&n.push(s)}),!e||e.replace(to,"").match(new RegExp(`^(?:(?:${n.join("|")}):|[^a-z]|[a-z+.-]+(?:[^a-z+.-:]|$))`,"i"))}const eo=D.create({name:"link",priority:1e3,keepOnSplit:!1,exitable:!0,onCreate(){this.options.protocols.forEach(e=>{if(typeof e=="string"){m.registerCustomProtocol(e);return}m.registerCustomProtocol(e.scheme,e.optionalSlashes)})},onDestroy(){m.reset()},inclusive(){return this.options.autolink},addOptions(){return{openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],defaultProtocol:"http",HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:e=>!!e}},addAttributes(){return{href:{default:null,parseHTML(e){return e.getAttribute("href")}},target:{default:this.options.HTMLAttributes.target},rel:{default:this.options.HTMLAttributes.rel},class:{default:this.options.HTMLAttributes.class}}},parseHTML(){return[{tag:"a[href]",getAttrs:e=>{const t=e.getAttribute("href");return!t||!de(t,this.options.protocols)?!1:null}}]},renderHTML({HTMLAttributes:e}){return de(e.href,this.options.protocols)?["a",O(this.options.HTMLAttributes,e),0]:["a",O(this.options.HTMLAttributes,{...e,href:""}),0]},addCommands(){return{setLink:e=>({chain:t})=>t().setMark(this.name,e).setMeta("preventAutolink",!0).run(),toggleLink:e=>({chain:t})=>t().toggleMark(this.name,e,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:e})=>e().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[F({find:e=>{const t=[];if(e){const{validate:n}=this.options,r=m.find(e).filter(s=>s.isLink&&n(s.value));r.length&&r.forEach(s=>t.push({text:s.value,data:{href:s.href},index:s.start}))}return t},type:this.type,getAttributes:e=>{var t;return{href:(t=e.data)===null||t===void 0?void 0:t.href}}})]},addProseMirrorPlugins(){const e=[];return this.options.autolink&&e.push(Xs({type:this.type,defaultProtocol:this.options.defaultProtocol,validate:this.options.validate})),this.options.openOnClick===!0&&e.push(Qs({type:this.type})),this.options.linkOnPaste&&e.push(Zs({editor:this.editor,defaultProtocol:this.options.defaultProtocol,type:this.type})),e}}),no=R.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",O(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{const{selection:n}=t,{$from:r,$to:s}=n,o=e();return r.parentOffset===0?o.insertContentAt({from:Math.max(r.pos-1,0),to:s.pos},{type:this.name}):xe(n)?o.insertContentAt(s.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:i,dispatch:a})=>{var c;if(a){const{$to:l}=i.selection,u=l.end();if(l.nodeAfter)l.nodeAfter.isTextblock?i.setSelection(m.TextSelection.create(i.doc,l.pos+1)):l.nodeAfter.isBlock?i.setSelection(m.NodeSelection.create(i.doc,l.pos)):i.setSelection(m.TextSelection.create(i.doc,l.pos));else{const d=(c=l.parent.type.contentMatch.defaultType)===null||c===void 0?void 0:c.create();d&&(i.insert(u,d),i.setSelection(m.TextSelection.create(i.doc,u+1)))}i.scrollIntoView()}return!0}).run()}}},addInputRules(){return[zt({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),ro=H.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>m.undo(e,t),redo:()=>({state:e,dispatch:t})=>m.redo(e,t)}},addProseMirrorPlugins(){return[m.history(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),so=H.create({name:"characterCount",addOptions(){return{limit:null,mode:"textSize",textCounter:e=>e.length,wordCounter:e=>e.split(" ").filter(t=>t!=="").length}},addStorage(){return{characters:()=>0,words:()=>0}},onBeforeCreate(){this.storage.characters=e=>{const t=(e==null?void 0:e.node)||this.editor.state.doc;if(((e==null?void 0:e.mode)||this.options.mode)==="textSize"){const r=t.textBetween(0,t.content.size,void 0," ");return this.options.textCounter(r)}return t.nodeSize},this.storage.words=e=>{const t=(e==null?void 0:e.node)||this.editor.state.doc,n=t.textBetween(0,t.content.size," "," ");return this.options.wordCounter(n)}},addProseMirrorPlugins(){return[new m.Plugin({key:new m.PluginKey("characterCount"),filterTransaction:(e,t)=>{const n=this.options.limit;if(!e.docChanged||n===0||n===null||n===void 0)return!0;const r=this.storage.characters({node:t.doc}),s=this.storage.characters({node:e.doc});if(s<=n||r>n&&s>n&&s<=r)return!0;if(r>n&&s>n&&s>r||!e.getMeta("paste"))return!1;const i=e.selection.$head.pos,a=s-n,c=i-a,l=i;return e.deleteRange(c,l),!(this.storage.characters({node:e.doc})>n)}})]}}),oo=H.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[m.dropCursor(this.options)]}}),io=H.create({name:"focus",addOptions(){return{className:"has-focus",mode:"all"}},addProseMirrorPlugins(){return[new m.Plugin({key:new m.PluginKey("focus"),props:{decorations:({doc:e,selection:t})=>{const{isEditable:n,isFocused:r}=this.editor,{anchor:s}=t,o=[];if(!n||!r)return m.DecorationSet.create(e,[]);let i=0;this.options.mode==="deepest"&&e.descendants((c,l)=>{if(c.isText)return;if(!(s>=l&&s<=l+c.nodeSize-1))return!1;i+=1});let a=0;return e.descendants((c,l)=>{if(c.isText||!(s>=l&&s<=l+c.nodeSize-1))return!1;if(a+=1,this.options.mode==="deepest"&&i-a>0||this.options.mode==="shallowest"&&a>1)return this.options.mode==="deepest";o.push(m.Decoration.node(l,l+c.nodeSize,{class:this.options.className}))}),m.DecorationSet.create(e,o)}}})]}}),ao=H.create({name:"gapCursor",addProseMirrorPlugins(){return[m.gapCursor()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=C(k(e,"allowGapCursor",n)))!==null&&t!==void 0?t:null}}}),lo=R.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",O(this.options.HTMLAttributes,e)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:r})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:s,storedMarks:o}=n;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:i}=this.options,{splittableMarks:a}=r.extensionManager,c=o||s.$to.parentOffset&&s.$from.marks();return t().insertContent({type:this.name}).command(({tr:l,dispatch:u})=>{if(u&&c&&i){const d=c.filter(p=>a.includes(p.type.name));l.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),co=R.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",O(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),uo=R.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",O(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),po=H.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new m.Plugin({key:new m.PluginKey("placeholder"),props:{decorations:({doc:e,selection:t})=>{const n=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=t,s=[];if(!n)return null;const o=this.editor.isEmpty;return e.descendants((i,a)=>{const c=r>=a&&r<=a+i.nodeSize,l=!i.isLeaf&&bt(i);if((c||!this.options.showOnlyCurrent)&&l){const u=[this.options.emptyNodeClass];o&&u.push(this.options.emptyEditorClass);const d=m.Decoration.node(a,a+i.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:i,pos:a,hasAnchor:c}):this.options.placeholder});s.push(d)}return this.options.includeChildren}),m.DecorationSet.create(e,s)}}})]}}),ho=R.create({name:"text",group:"inline"}),fo=R.create({name:"doc",topNode:!0,content:"block+"}),mo=D.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(e){return e!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sub",O(this.options.HTMLAttributes,e),0]},addCommands(){return{setSubscript:()=>({commands:e})=>e.setMark(this.name),toggleSubscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSubscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}}),go=D.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(e){return e!=="super"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sup",O(this.options.HTMLAttributes,e),0]},addCommands(){return{setSuperscript:()=>({commands:e})=>e.setMark(this.name),toggleSuperscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSuperscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}});function yo(e){var t;const{char:n,allowSpaces:r,allowedPrefixes:s,startOfLine:o,$position:i}=e,a=Hr(n),c=new RegExp(`\\s${a}$`),l=o?"^":"",u=r?new RegExp(`${l}${a}.*?(?=\\s${a}|$)`,"gm"):new RegExp(`${l}(?:^)?${a}[^\\s${a}]*`,"gm"),d=((t=i.nodeBefore)===null||t===void 0?void 0:t.isText)&&i.nodeBefore.text;if(!d)return null;const p=i.pos-d.length,h=Array.from(d.matchAll(u)).pop();if(!h||h.input===void 0||h.index===void 0)return null;const f=h.input.slice(Math.max(0,h.index-1),h.index),g=new RegExp(`^[${s==null?void 0:s.join("")}\0]?$`).test(f);if(s!==null&&!g)return null;const y=p+h.index;let v=y+h[0].length;return r&&c.test(d.slice(v-1,v+1))&&(h[0]+=" ",v+=1),y<i.pos&&v>=i.pos?{range:{from:y,to:v},query:h[0].slice(n.length),text:h[0]}:null}const vo=new m.PluginKey("suggestion");function De({pluginKey:e=vo,editor:t,char:n="@",allowSpaces:r=!1,allowedPrefixes:s=[" "],startOfLine:o=!1,decorationTag:i="span",decorationClass:a="suggestion",command:c=()=>null,items:l=()=>[],render:u=()=>({}),allow:d=()=>!0,findSuggestionMatch:p=yo}){let h;const f=u==null?void 0:u(),g=new m.Plugin({key:e,view(){return{update:async(y,v)=>{var w,M,b,E,S,x,L;const T=(w=this.key)===null||w===void 0?void 0:w.getState(v),P=(M=this.key)===null||M===void 0?void 0:M.getState(y.state),N=T.active&&P.active&&T.range.from!==P.range.from,B=!T.active&&P.active,G=T.active&&!P.active,V=!B&&!G&&T.query!==P.query,W=B||N&&V,j=V||N,K=G||N&&V;if(!W&&!j&&!K)return;const J=K&&!W?T:P,Kt=y.dom.querySelector(`[data-decoration-id="${J.decorationId}"]`);h={editor:t,range:J.range,query:J.query,text:J.text,items:[],command:Q=>c({editor:t,range:J.range,props:Q}),decorationNode:Kt,clientRect:Kt?()=>{var Q;const{decorationId:Ie}=(Q=this.key)===null||Q===void 0?void 0:Q.getState(t.state),St=y.dom.querySelector(`[data-decoration-id="${Ie}"]`);return(St==null?void 0:St.getBoundingClientRect())||null}:null},W&&((b=f==null?void 0:f.onBeforeStart)===null||b===void 0||b.call(f,h)),j&&((E=f==null?void 0:f.onBeforeUpdate)===null||E===void 0||E.call(f,h)),(j||W)&&(h.items=await l({editor:t,query:J.query})),K&&((S=f==null?void 0:f.onExit)===null||S===void 0||S.call(f,h)),j&&((x=f==null?void 0:f.onUpdate)===null||x===void 0||x.call(f,h)),W&&((L=f==null?void 0:f.onStart)===null||L===void 0||L.call(f,h))},destroy:()=>{var y;h&&((y=f==null?void 0:f.onExit)===null||y===void 0||y.call(f,h))}}},state:{init(){return{active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}},apply(y,v,w,M){const{isEditable:b}=t,{composing:E}=t.view,{selection:S}=y,{empty:x,from:L}=S,T={...v};if(T.composing=E,b&&(x||t.view.composing)){(L<v.range.from||L>v.range.to)&&!E&&!v.composing&&(T.active=!1);const P=p({char:n,allowSpaces:r,allowedPrefixes:s,startOfLine:o,$position:S.$from}),N=`id_${Math.floor(Math.random()*4294967295)}`;P&&d({editor:t,state:M,range:P.range,isActive:v.active})?(T.active=!0,T.decorationId=v.decorationId?v.decorationId:N,T.range=P.range,T.query=P.query,T.text=P.text):T.active=!1}else T.active=!1;return T.active||(T.decorationId=null,T.range={from:0,to:0},T.query=null,T.text=null),T}},props:{handleKeyDown(y,v){var w;const{active:M,range:b}=g.getState(y.state);return M&&((w=f==null?void 0:f.onKeyDown)===null||w===void 0?void 0:w.call(f,{view:y,event:v,range:b}))||!1},decorations(y){const{active:v,range:w,decorationId:M}=g.getState(y);return v?m.DecorationSet.create(y.doc,[m.Decoration.inline(w.from,w.to,{nodeName:i,class:a,"data-decoration-id":M})]):null}}});return g}const bo=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,Mo=R.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:e}){return["img",O(this.options.HTMLAttributes,e)]},addCommands(){return{setImage:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[zt({find:bo,type:this.type,getAttributes:e=>{const[,,t,n,r]=e;return{src:n,alt:t,title:r}}})]}}),So=R.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:e}){return["tr",O(this.options.HTMLAttributes,e),0]}});function ue(e,t,n,r,s,o){let i=0,a=!0,c=t.firstChild;const l=e.firstChild;for(let u=0,d=0;u<l.childCount;u+=1){const{colspan:p,colwidth:h}=l.child(u).attrs;for(let f=0;f<p;f+=1,d+=1){const g=s===d?o:h&&h[f],y=g?`${g}px`:"";i+=g||r,g||(a=!1),c?(c.style.width!==y&&(c.style.width=y),c=c.nextSibling):t.appendChild(document.createElement("col")).style.width=y}}for(;c;){const u=c.nextSibling;c.parentNode.removeChild(c),c=u}a?(n.style.width=`${i}px`,n.style.minWidth=""):(n.style.width="",n.style.minWidth=`${i}px`)}class ko{constructor(t,n){this.node=t,this.cellMinWidth=n,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),ue(t,this.colgroup,this.table,n),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,ue(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){return t.type==="attributes"&&(t.target===this.table||this.colgroup.contains(t.target))}}function wo(e,t,n,r){let s=0,o=!0;const i=[],a=e.firstChild;if(!a)return{};for(let d=0,p=0;d<a.childCount;d+=1){const{colspan:h,colwidth:f}=a.child(d).attrs;for(let g=0;g<h;g+=1,p+=1){const y=n===p?r:f&&f[g],v=y?`${y}px`:"";s+=y||t,y||(o=!1),i.push(["col",v?{style:`width: ${v}`}:{}])}}const c=o?`${s}px`:"",l=o?"":`${s}px`;return{colgroup:["colgroup",{},...i],tableWidth:c,tableMinWidth:l}}function pe(e,t){return e.createAndFill()}function To(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;const t={};return Object.keys(e.nodes).forEach(n=>{const r=e.nodes[n];r.spec.tableRole&&(t[r.spec.tableRole]=r)}),e.cached.tableNodeTypes=t,t}function Eo(e,t,n,r,s){const o=To(e),i=[],a=[];for(let l=0;l<n;l+=1){const u=pe(o.cell);if(u&&a.push(u),r){const d=pe(o.header_cell);d&&i.push(d)}}const c=[];for(let l=0;l<t;l+=1)c.push(o.row.createChecked(null,r&&l===0?i:a));return o.table.createChecked(null,c)}function Co(e){return e instanceof m.CellSelection}const ot=({editor:e})=>{const{selection:t}=e.state;if(!Co(t))return!1;let n=0;const r=Te(t.ranges[0].$from,o=>o.type.name==="table");return r==null||r.node.descendants(o=>{if(o.type.name==="table")return!1;["tableCell","tableHeader"].includes(o.type.name)&&(n+=1)}),n===t.ranges.length?(e.commands.deleteTable(),!0):!1},xo=R.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:ko,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({node:e,HTMLAttributes:t}){const{colgroup:n,tableWidth:r,tableMinWidth:s}=wo(e,this.options.cellMinWidth);return["table",O(this.options.HTMLAttributes,t,{style:r?`width: ${r}`:`min-width: ${s}`}),n,["tbody",0]]},addCommands(){return{insertTable:({rows:e=3,cols:t=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:s,editor:o})=>{const i=Eo(o.schema,e,t,n);if(s){const a=r.selection.from+1;r.replaceSelectionWith(i).scrollIntoView().setSelection(m.TextSelection.near(r.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:e,dispatch:t})=>m.addColumnBefore(e,t),addColumnAfter:()=>({state:e,dispatch:t})=>m.addColumnAfter(e,t),deleteColumn:()=>({state:e,dispatch:t})=>m.deleteColumn(e,t),addRowBefore:()=>({state:e,dispatch:t})=>m.addRowBefore(e,t),addRowAfter:()=>({state:e,dispatch:t})=>m.addRowAfter(e,t),deleteRow:()=>({state:e,dispatch:t})=>m.deleteRow(e,t),deleteTable:()=>({state:e,dispatch:t})=>m.deleteTable(e,t),mergeCells:()=>({state:e,dispatch:t})=>m.mergeCells(e,t),splitCell:()=>({state:e,dispatch:t})=>m.splitCell(e,t),toggleHeaderColumn:()=>({state:e,dispatch:t})=>m.toggleHeader("column")(e,t),toggleHeaderRow:()=>({state:e,dispatch:t})=>m.toggleHeader("row")(e,t),toggleHeaderCell:()=>({state:e,dispatch:t})=>m.toggleHeaderCell(e,t),mergeOrSplit:()=>({state:e,dispatch:t})=>m.mergeCells(e,t)?!0:m.splitCell(e,t),setCellAttribute:(e,t)=>({state:n,dispatch:r})=>m.setCellAttr(e,t)(n,r),goToNextCell:()=>({state:e,dispatch:t})=>m.goToNextCell(1)(e,t),goToPreviousCell:()=>({state:e,dispatch:t})=>m.goToNextCell(-1)(e,t),fixTables:()=>({state:e,dispatch:t})=>(t&&m.fixTables(e),!0),setCellSelection:e=>({tr:t,dispatch:n})=>{if(n){const r=m.CellSelection.create(t.doc,e.anchorCell,e.headCell);t.setSelection(r)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:ot,"Mod-Backspace":ot,Delete:ot,"Mod-Delete":ot}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[m.columnResizing({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],m.tableEditing({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(e){const t={name:e.name,options:e.options,storage:e.storage};return{tableRole:C(k(e,"tableRole",t))}}}),Ao=R.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?t.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:e}){return["td",O(this.options.HTMLAttributes,e),0]}}),Oo=R.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?t.split(",").map(r=>parseInt(r,10)):null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:e}){return["th",O(this.options.HTMLAttributes,e),0]}}),Lo=new m.PluginKey("mention"),Po=R.create({name:"mention",priority:101,addOptions(){return{HTMLAttributes:{},renderText({options:e,node:t}){var n;return`${e.suggestion.char}${(n=t.attrs.label)!==null&&n!==void 0?n:t.attrs.id}`},deleteTriggerWithBackspace:!1,renderHTML({options:e,node:t}){var n;return["span",O(this.HTMLAttributes,e.HTMLAttributes),`${e.suggestion.char}${(n=t.attrs.label)!==null&&n!==void 0?n:t.attrs.id}`]},suggestion:{char:"@",pluginKey:Lo,command:({editor:e,range:t,props:n})=>{var r,s,o;const i=e.view.state.selection.$to.nodeAfter;((r=i==null?void 0:i.text)===null||r===void 0?void 0:r.startsWith(" "))&&(t.to+=1),e.chain().focus().insertContentAt(t,[{type:this.name,attrs:n},{type:"text",text:" "}]).run(),(o=(s=e.view.dom.ownerDocument.defaultView)===null||s===void 0?void 0:s.getSelection())===null||o===void 0||o.collapseToEnd()},allow:({state:e,range:t})=>{const n=e.doc.resolve(t.from),r=e.schema.nodes[this.name];return!!n.parent.type.contentMatch.matchType(r)}}}},group:"inline",inline:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>e.id?{"data-id":e.id}:{}},label:{default:null,parseHTML:e=>e.getAttribute("data-label"),renderHTML:e=>e.label?{"data-label":e.label}:{}}}},parseHTML(){return[{tag:`span[data-type="${this.name}"]`}]},renderHTML({node:e,HTMLAttributes:t}){if(this.options.renderLabel!==void 0)return console.warn("renderLabel is deprecated use renderText and renderHTML instead"),["span",O({"data-type":this.name},this.options.HTMLAttributes,t),this.options.renderLabel({options:this.options,node:e})];const n={...this.options};n.HTMLAttributes=O({"data-type":this.name},this.options.HTMLAttributes,t);const r=this.options.renderHTML({options:n,node:e});return typeof r=="string"?["span",O({"data-type":this.name},this.options.HTMLAttributes,t),r]:r},renderText({node:e}){return this.options.renderLabel!==void 0?(console.warn("renderLabel is deprecated use renderText and renderHTML instead"),this.options.renderLabel({options:this.options,node:e})):this.options.renderText({options:this.options,node:e})},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:e,state:t})=>{let n=!1;const{selection:r}=t,{empty:s,anchor:o}=r;return s?(t.doc.nodesBetween(o-1,o,(i,a)=>{if(i.type.name===this.name)return n=!0,e.insertText(this.options.deleteTriggerWithBackspace?"":this.options.suggestion.char||"",a,a+i.nodeSize),!1}),n):!1})}},addProseMirrorPlugins(){return[De({editor:this.editor,...this.options.suggestion})]}});exports.Blockquote=Js;exports.Bold=Br;exports.BubbleMenu=as;exports.BulletList=zs;exports.CharacterCount=so;exports.Code=Os;exports.CodeBlock=Rs;exports.Color=Ns;exports.Document=fo;exports.DragHandlePlugin=ys;exports.Dropcursor=oo;exports.EditorContent=Jr;exports.Extension=H;exports.FocusClasses=io;exports.FontFamily=_s;exports.Gapcursor=ao;exports.HardBreak=lo;exports.Heading=Ds;exports.Highlight=js;exports.History=ro;exports.HorizontalRule=no;exports.Image=Mo;exports.Italic=ks;exports.Link=eo;exports.ListItem=co;exports.Mention=Po;exports.Node=R;exports.NodeViewContent=ls;exports.NodeViewWrapper=cs;exports.OrderedList=Ws;exports.Paragraph=uo;exports.Placeholder=po;exports.ReactNodeViewRenderer=hs;exports.ReactRenderer=Re;exports.Strike=Cs;exports.Subscript=mo;exports.Suggestion=De;exports.Superscript=go;exports.Table=xo;exports.TableCell=Ao;exports.TableHeader=Oo;exports.TableRow=So;exports.TaskItem=qs;exports.TaskList=Us;exports.Text=ho;exports.TextAlign=Is;exports.TextStyle=Hs;exports.Underline=ws;exports.dragHandlePluginDefaultKey=_e;exports.findChildren=qn;exports.findParentNode=vt;exports.getMarkRange=mt;exports.isActive=Ce;exports.isList=Ht;exports.isNumber=ye;exports.mergeAttributes=O;exports.nodeInputRule=zt;exports.nodePasteRule=_r;exports.useEditor=os;
